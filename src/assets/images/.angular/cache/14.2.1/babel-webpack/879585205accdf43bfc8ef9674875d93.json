{"ast":null,"code":"import _get from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _assertThisInitialized from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _slicedToArray from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _defineProperty from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _createClass from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _inherits from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _createForOfIteratorHelper from \"C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport { m as mergeProps, g as guid, i as isArraysEqual, T as Theme, a as mapHash, B as BaseComponent, V as ViewContextType, C as ContentContainer, b as buildViewClassNames, c as greatestDurationDenominator, d as createDuration, e as BASE_OPTION_DEFAULTS, f as arrayToHash, h as filterHash, j as buildEventSourceRefiners, p as parseEventSource, k as formatWithOrdinals, u as unpromisify, l as buildRangeApiWithTimeZone, n as identity, r as requestJson, s as subtractDurations, o as intersectRanges, q as startOfDay, t as addDays, v as hashValuesToArray, w as buildEventApis, D as DelayedRunner, x as createFormatter, y as diffWholeDays, z as memoize, A as memoizeObjArg, E as isPropsEqual, F as Emitter, G as getInitialDate, H as rangeContainsMarker, I as createEmptyEventStore, J as reduceCurrentDate, K as reduceEventStore, L as rezoneEventStoreDates, M as mergeRawOptions, N as BASE_OPTION_REFINERS, O as CALENDAR_LISTENER_REFINERS, P as CALENDAR_OPTION_REFINERS, Q as COMPLEX_OPTION_COMPARATORS, R as VIEW_OPTION_REFINERS, S as DateEnv, U as DateProfileGenerator, W as createEventUi, X as parseBusinessHours, Y as setRef, Z as Interaction, _ as getElSeg, $ as elementClosest, a0 as EventImpl, a1 as listenBySelector, a2 as listenToHoverBySelector, a3 as PureComponent, a4 as buildViewContext, a5 as getUniqueDomId, a6 as parseInteractionSettings, a7 as interactionSettingsStore, a8 as getNow, a9 as CalendarImpl, aa as flushSync, ab as CalendarRoot, ac as RenderId, ad as ensureElHasStyles, ae as applyStyleProp, af as sliceEventStore } from './internal-common.js';\nexport { ag as JsonRequestError } from './internal-common.js';\nimport { createElement, createRef, Fragment, render } from 'preact';\nimport 'preact/compat';\nvar globalLocales = [];\nvar MINIMAL_RAW_EN_LOCALE = {\n  code: 'en',\n  week: {\n    dow: 0,\n    doy: 4 // 4 days need to be within the year to be considered the first week\n\n  },\n  direction: 'ltr',\n  buttonText: {\n    prev: 'prev',\n    next: 'next',\n    prevYear: 'prev year',\n    nextYear: 'next year',\n    year: 'year',\n    today: 'today',\n    month: 'month',\n    week: 'week',\n    day: 'day',\n    list: 'list'\n  },\n  weekText: 'W',\n  weekTextLong: 'Week',\n  closeHint: 'Close',\n  timeHint: 'Time',\n  eventHint: 'Event',\n  allDayText: 'all-day',\n  moreLinkText: 'more',\n  noEventsText: 'No events to display'\n};\nvar RAW_EN_LOCALE = Object.assign(Object.assign({}, MINIMAL_RAW_EN_LOCALE), {\n  // Includes things we don't want other locales to inherit,\n  // things that derive from other translatable strings.\n  buttonHints: {\n    prev: 'Previous $0',\n    next: 'Next $0',\n    today: function today(buttonText, unit) {\n      return unit === 'day' ? 'Today' : \"This \".concat(buttonText);\n    }\n  },\n  viewHint: '$0 view',\n  navLinkHint: 'Go to $0',\n  moreLinkHint: function moreLinkHint(eventCnt) {\n    return \"Show \".concat(eventCnt, \" more event\").concat(eventCnt === 1 ? '' : 's');\n  }\n});\n\nfunction organizeRawLocales(explicitRawLocales) {\n  var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n  var allRawLocales = globalLocales.concat(explicitRawLocales);\n  var rawLocaleMap = {\n    en: RAW_EN_LOCALE\n  };\n\n  var _iterator = _createForOfIteratorHelper(allRawLocales),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var rawLocale = _step.value;\n      rawLocaleMap[rawLocale.code] = rawLocale;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return {\n    map: rawLocaleMap,\n    defaultCode: defaultCode\n  };\n}\n\nfunction buildLocale(inputSingular, available) {\n  if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n    return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n  }\n\n  return queryLocale(inputSingular, available);\n}\n\nfunction queryLocale(codeArg, available) {\n  var codes = [].concat(codeArg || []); // will convert to array\n\n  var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n  return parseLocale(codeArg, codes, raw);\n}\n\nfunction queryRawLocale(codes, available) {\n  for (var i = 0; i < codes.length; i += 1) {\n    var parts = codes[i].toLocaleLowerCase().split('-');\n\n    for (var j = parts.length; j > 0; j -= 1) {\n      var simpleId = parts.slice(0, j).join('-');\n\n      if (available[simpleId]) {\n        return available[simpleId];\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction parseLocale(codeArg, codes, raw) {\n  var merged = mergeProps([MINIMAL_RAW_EN_LOCALE, raw], ['buttonText']);\n  delete merged.code; // don't want this part of the options\n\n  var week = merged.week;\n  delete merged.week;\n  return {\n    codeArg: codeArg,\n    codes: codes,\n    week: week,\n    simpleNumberFormat: new Intl.NumberFormat(codeArg),\n    options: merged\n  };\n} // TODO: easier way to add new hooks? need to update a million things\n\n\nfunction createPlugin(input) {\n  return {\n    id: guid(),\n    name: input.name,\n    premiumReleaseDate: input.premiumReleaseDate ? new Date(input.premiumReleaseDate) : undefined,\n    deps: input.deps || [],\n    reducers: input.reducers || [],\n    isLoadingFuncs: input.isLoadingFuncs || [],\n    contextInit: [].concat(input.contextInit || []),\n    eventRefiners: input.eventRefiners || {},\n    eventDefMemberAdders: input.eventDefMemberAdders || [],\n    eventSourceRefiners: input.eventSourceRefiners || {},\n    isDraggableTransformers: input.isDraggableTransformers || [],\n    eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n    eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n    dateSelectionTransformers: input.dateSelectionTransformers || [],\n    datePointTransforms: input.datePointTransforms || [],\n    dateSpanTransforms: input.dateSpanTransforms || [],\n    views: input.views || {},\n    viewPropsTransformers: input.viewPropsTransformers || [],\n    isPropsValid: input.isPropsValid || null,\n    externalDefTransforms: input.externalDefTransforms || [],\n    viewContainerAppends: input.viewContainerAppends || [],\n    eventDropTransformers: input.eventDropTransformers || [],\n    componentInteractions: input.componentInteractions || [],\n    calendarInteractions: input.calendarInteractions || [],\n    themeClasses: input.themeClasses || {},\n    eventSourceDefs: input.eventSourceDefs || [],\n    cmdFormatter: input.cmdFormatter,\n    recurringTypes: input.recurringTypes || [],\n    namedTimeZonedImpl: input.namedTimeZonedImpl,\n    initialView: input.initialView || '',\n    elementDraggingImpl: input.elementDraggingImpl,\n    optionChangeHandlers: input.optionChangeHandlers || {},\n    scrollGridImpl: input.scrollGridImpl || null,\n    listenerRefiners: input.listenerRefiners || {},\n    optionRefiners: input.optionRefiners || {},\n    propSetHandlers: input.propSetHandlers || {}\n  };\n}\n\nfunction buildPluginHooks(pluginDefs, globalDefs) {\n  var currentPluginIds = {};\n  var hooks = {\n    premiumReleaseDate: undefined,\n    reducers: [],\n    isLoadingFuncs: [],\n    contextInit: [],\n    eventRefiners: {},\n    eventDefMemberAdders: [],\n    eventSourceRefiners: {},\n    isDraggableTransformers: [],\n    eventDragMutationMassagers: [],\n    eventDefMutationAppliers: [],\n    dateSelectionTransformers: [],\n    datePointTransforms: [],\n    dateSpanTransforms: [],\n    views: {},\n    viewPropsTransformers: [],\n    isPropsValid: null,\n    externalDefTransforms: [],\n    viewContainerAppends: [],\n    eventDropTransformers: [],\n    componentInteractions: [],\n    calendarInteractions: [],\n    themeClasses: {},\n    eventSourceDefs: [],\n    cmdFormatter: null,\n    recurringTypes: [],\n    namedTimeZonedImpl: null,\n    initialView: '',\n    elementDraggingImpl: null,\n    optionChangeHandlers: {},\n    scrollGridImpl: null,\n    listenerRefiners: {},\n    optionRefiners: {},\n    propSetHandlers: {}\n  };\n\n  function addDefs(defs) {\n    var _iterator2 = _createForOfIteratorHelper(defs),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var def = _step2.value;\n        var pluginName = def.name;\n        var currentId = currentPluginIds[pluginName];\n\n        if (currentId === undefined) {\n          currentPluginIds[pluginName] = def.id;\n          addDefs(def.deps);\n          hooks = combineHooks(hooks, def);\n        } else if (currentId !== def.id) {\n          // different ID than the one already added\n          console.warn(\"Duplicate plugin '\".concat(pluginName, \"'\"));\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  }\n\n  if (pluginDefs) {\n    addDefs(pluginDefs);\n  }\n\n  addDefs(globalDefs);\n  return hooks;\n}\n\nfunction buildBuildPluginHooks() {\n  var currentOverrideDefs = [];\n  var currentGlobalDefs = [];\n  var currentHooks;\n  return function (overrideDefs, globalDefs) {\n    if (!currentHooks || !isArraysEqual(overrideDefs, currentOverrideDefs) || !isArraysEqual(globalDefs, currentGlobalDefs)) {\n      currentHooks = buildPluginHooks(overrideDefs, globalDefs);\n    }\n\n    currentOverrideDefs = overrideDefs;\n    currentGlobalDefs = globalDefs;\n    return currentHooks;\n  };\n}\n\nfunction combineHooks(hooks0, hooks1) {\n  return {\n    premiumReleaseDate: compareOptionalDates(hooks0.premiumReleaseDate, hooks1.premiumReleaseDate),\n    reducers: hooks0.reducers.concat(hooks1.reducers),\n    isLoadingFuncs: hooks0.isLoadingFuncs.concat(hooks1.isLoadingFuncs),\n    contextInit: hooks0.contextInit.concat(hooks1.contextInit),\n    eventRefiners: Object.assign(Object.assign({}, hooks0.eventRefiners), hooks1.eventRefiners),\n    eventDefMemberAdders: hooks0.eventDefMemberAdders.concat(hooks1.eventDefMemberAdders),\n    eventSourceRefiners: Object.assign(Object.assign({}, hooks0.eventSourceRefiners), hooks1.eventSourceRefiners),\n    isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n    eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n    eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n    dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n    datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n    dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n    views: Object.assign(Object.assign({}, hooks0.views), hooks1.views),\n    viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n    isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n    externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n    viewContainerAppends: hooks0.viewContainerAppends.concat(hooks1.viewContainerAppends),\n    eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n    calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n    componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n    themeClasses: Object.assign(Object.assign({}, hooks0.themeClasses), hooks1.themeClasses),\n    eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n    cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n    recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n    namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n    initialView: hooks0.initialView || hooks1.initialView,\n    elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n    optionChangeHandlers: Object.assign(Object.assign({}, hooks0.optionChangeHandlers), hooks1.optionChangeHandlers),\n    scrollGridImpl: hooks1.scrollGridImpl || hooks0.scrollGridImpl,\n    listenerRefiners: Object.assign(Object.assign({}, hooks0.listenerRefiners), hooks1.listenerRefiners),\n    optionRefiners: Object.assign(Object.assign({}, hooks0.optionRefiners), hooks1.optionRefiners),\n    propSetHandlers: Object.assign(Object.assign({}, hooks0.propSetHandlers), hooks1.propSetHandlers)\n  };\n}\n\nfunction compareOptionalDates(date0, date1) {\n  if (date0 === undefined) {\n    return date1;\n  }\n\n  if (date1 === undefined) {\n    return date0;\n  }\n\n  return new Date(Math.max(date0.valueOf(), date1.valueOf()));\n}\n\nvar StandardTheme = /*#__PURE__*/function (_Theme) {\n  _inherits(StandardTheme, _Theme);\n\n  var _super = _createSuper(StandardTheme);\n\n  function StandardTheme() {\n    _classCallCheck(this, StandardTheme);\n\n    return _super.apply(this, arguments);\n  }\n\n  return _createClass(StandardTheme);\n}(Theme);\n\nStandardTheme.prototype.classes = {\n  root: 'fc-theme-standard',\n  tableCellShaded: 'fc-cell-shaded',\n  buttonGroup: 'fc-button-group',\n  button: 'fc-button fc-button-primary',\n  buttonActive: 'fc-button-active'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n  close: 'fc-icon-x',\n  prev: 'fc-icon-chevron-left',\n  next: 'fc-icon-chevron-right',\n  prevYear: 'fc-icon-chevrons-left',\n  nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.rtlIconClasses = {\n  prev: 'fc-icon-chevron-right',\n  next: 'fc-icon-chevron-left',\n  prevYear: 'fc-icon-chevrons-right',\n  nextYear: 'fc-icon-chevrons-left'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons'; // TODO: make TS-friendly\n\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n  var hash = {};\n  var viewType;\n\n  for (viewType in defaultConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  for (viewType in overrideConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  return hash;\n}\n\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  if (hash[viewType]) {\n    return hash[viewType];\n  }\n\n  var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n\n  if (viewDef) {\n    hash[viewType] = viewDef;\n  }\n\n  return viewDef;\n}\n\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  var defaultConfig = defaultConfigs[viewType];\n  var overrideConfig = overrideConfigs[viewType];\n\n  var queryProp = function queryProp(name) {\n    return defaultConfig && defaultConfig[name] !== null ? defaultConfig[name] : overrideConfig && overrideConfig[name] !== null ? overrideConfig[name] : null;\n  };\n\n  var theComponent = queryProp('component');\n  var superType = queryProp('superType');\n  var superDef = null;\n\n  if (superType) {\n    if (superType === viewType) {\n      throw new Error('Can\\'t have a custom view type that references itself');\n    }\n\n    superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  if (!theComponent && superDef) {\n    theComponent = superDef.component;\n  }\n\n  if (!theComponent) {\n    return null; // don't throw a warning, might be settings for a single-unit view\n  }\n\n  return {\n    type: viewType,\n    component: theComponent,\n    defaults: Object.assign(Object.assign({}, superDef ? superDef.defaults : {}), defaultConfig ? defaultConfig.rawOptions : {}),\n    overrides: Object.assign(Object.assign({}, superDef ? superDef.overrides : {}), overrideConfig ? overrideConfig.rawOptions : {})\n  };\n}\n\nfunction parseViewConfigs(inputs) {\n  return mapHash(inputs, parseViewConfig);\n}\n\nfunction parseViewConfig(input) {\n  var rawOptions = typeof input === 'function' ? {\n    component: input\n  } : input;\n  var component = rawOptions.component;\n\n  if (rawOptions.content) {\n    // TODO: remove content/classNames/didMount/etc from options?\n    component = createViewHookComponent(rawOptions);\n  } else if (component && !(component.prototype instanceof BaseComponent)) {\n    // WHY?: people were using `component` property for `content`\n    // TODO: converge on one setting name\n    component = createViewHookComponent(Object.assign(Object.assign({}, rawOptions), {\n      content: component\n    }));\n  }\n\n  return {\n    superType: rawOptions.type,\n    component: component,\n    rawOptions: rawOptions // includes type and component too :(\n\n  };\n}\n\nfunction createViewHookComponent(options) {\n  return function (viewProps) {\n    return createElement(ViewContextType.Consumer, null, function (context) {\n      return createElement(ContentContainer, {\n        elTag: \"div\",\n        elClasses: buildViewClassNames(context.viewSpec),\n        renderProps: Object.assign(Object.assign({}, viewProps), {\n          nextDayThreshold: context.options.nextDayThreshold\n        }),\n        generatorName: undefined,\n        customGenerator: options.content,\n        classNameGenerator: options.classNames,\n        didMount: options.didMount,\n        willUnmount: options.willUnmount\n      });\n    });\n  };\n}\n\nfunction buildViewSpecs(defaultInputs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n  var defaultConfigs = parseViewConfigs(defaultInputs);\n  var overrideConfigs = parseViewConfigs(optionOverrides.views);\n  var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n  return mapHash(viewDefs, function (viewDef) {\n    return buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults);\n  });\n}\n\nfunction buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n  var durationInput = viewDef.overrides.duration || viewDef.defaults.duration || dynamicOptionOverrides.duration || optionOverrides.duration;\n  var duration = null;\n  var durationUnit = '';\n  var singleUnit = '';\n  var singleUnitOverrides = {};\n\n  if (durationInput) {\n    duration = createDurationCached(durationInput);\n\n    if (duration) {\n      // valid?\n      var denom = greatestDurationDenominator(duration);\n      durationUnit = denom.unit;\n\n      if (denom.value === 1) {\n        singleUnit = durationUnit;\n        singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].rawOptions : {};\n      }\n    }\n  }\n\n  var queryButtonText = function queryButtonText(optionsSubset) {\n    var buttonTextMap = optionsSubset.buttonText || {};\n    var buttonTextKey = viewDef.defaults.buttonTextKey;\n\n    if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n      return buttonTextMap[buttonTextKey];\n    }\n\n    if (buttonTextMap[viewDef.type] != null) {\n      return buttonTextMap[viewDef.type];\n    }\n\n    if (buttonTextMap[singleUnit] != null) {\n      return buttonTextMap[singleUnit];\n    }\n\n    return null;\n  };\n\n  var queryButtonTitle = function queryButtonTitle(optionsSubset) {\n    var buttonHints = optionsSubset.buttonHints || {};\n    var buttonKey = viewDef.defaults.buttonTextKey; // use same key as text\n\n    if (buttonKey != null && buttonHints[buttonKey] != null) {\n      return buttonHints[buttonKey];\n    }\n\n    if (buttonHints[viewDef.type] != null) {\n      return buttonHints[viewDef.type];\n    }\n\n    if (buttonHints[singleUnit] != null) {\n      return buttonHints[singleUnit];\n    }\n\n    return null;\n  };\n\n  return {\n    type: viewDef.type,\n    component: viewDef.component,\n    duration: duration,\n    durationUnit: durationUnit,\n    singleUnit: singleUnit,\n    optionDefaults: viewDef.defaults,\n    optionOverrides: Object.assign(Object.assign({}, singleUnitOverrides), viewDef.overrides),\n    buttonTextOverride: queryButtonText(dynamicOptionOverrides) || queryButtonText(optionOverrides) || // constructor-specified buttonText lookup hash takes precedence\n    viewDef.overrides.buttonText,\n    buttonTextDefault: queryButtonText(localeDefaults) || viewDef.defaults.buttonText || queryButtonText(BASE_OPTION_DEFAULTS) || viewDef.type,\n    // not DRY\n    buttonTitleOverride: queryButtonTitle(dynamicOptionOverrides) || queryButtonTitle(optionOverrides) || viewDef.overrides.buttonHint,\n    buttonTitleDefault: queryButtonTitle(localeDefaults) || viewDef.defaults.buttonHint || queryButtonTitle(BASE_OPTION_DEFAULTS) // will eventually fall back to buttonText\n\n  };\n} // hack to get memoization working\n\n\nvar durationInputMap = {};\n\nfunction createDurationCached(durationInput) {\n  var json = JSON.stringify(durationInput);\n  var res = durationInputMap[json];\n\n  if (res === undefined) {\n    res = createDuration(durationInput);\n    durationInputMap[json] = res;\n  }\n\n  return res;\n}\n\nfunction reduceViewType(viewType, action) {\n  switch (action.type) {\n    case 'CHANGE_VIEW_TYPE':\n      viewType = action.viewType;\n  }\n\n  return viewType;\n}\n\nfunction reduceDynamicOptionOverrides(dynamicOptionOverrides, action) {\n  switch (action.type) {\n    case 'SET_OPTION':\n      return Object.assign(Object.assign({}, dynamicOptionOverrides), _defineProperty({}, action.optionName, action.rawOptionValue));\n\n    default:\n      return dynamicOptionOverrides;\n  }\n}\n\nfunction reduceDateProfile(currentDateProfile, action, currentDate, dateProfileGenerator) {\n  var dp;\n\n  switch (action.type) {\n    case 'CHANGE_VIEW_TYPE':\n      return dateProfileGenerator.build(action.dateMarker || currentDate);\n\n    case 'CHANGE_DATE':\n      return dateProfileGenerator.build(action.dateMarker);\n\n    case 'PREV':\n      dp = dateProfileGenerator.buildPrev(currentDateProfile, currentDate);\n\n      if (dp.isValid) {\n        return dp;\n      }\n\n      break;\n\n    case 'NEXT':\n      dp = dateProfileGenerator.buildNext(currentDateProfile, currentDate);\n\n      if (dp.isValid) {\n        return dp;\n      }\n\n      break;\n  }\n\n  return currentDateProfile;\n}\n\nfunction initEventSources(calendarOptions, dateProfile, context) {\n  var activeRange = dateProfile ? dateProfile.activeRange : null;\n  return addSources({}, parseInitialSources(calendarOptions, context), activeRange, context);\n}\n\nfunction reduceEventSources(eventSources, action, dateProfile, context) {\n  var activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n\n  switch (action.type) {\n    case 'ADD_EVENT_SOURCES':\n      // already parsed\n      return addSources(eventSources, action.sources, activeRange, context);\n\n    case 'REMOVE_EVENT_SOURCE':\n      return removeSource(eventSources, action.sourceId);\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n\n    case 'NEXT':\n    case 'CHANGE_DATE':\n    case 'CHANGE_VIEW_TYPE':\n      if (dateProfile) {\n        return fetchDirtySources(eventSources, activeRange, context);\n      }\n\n      return eventSources;\n\n    case 'FETCH_EVENT_SOURCES':\n      return fetchSourcesByIds(eventSources, action.sourceIds ? // why no type?\n      arrayToHash(action.sourceIds) : excludeStaticSources(eventSources, context), activeRange, action.isRefetch || false, context);\n\n    case 'RECEIVE_EVENTS':\n    case 'RECEIVE_EVENT_ERROR':\n      return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return {};\n\n    default:\n      return eventSources;\n  }\n}\n\nfunction reduceEventSourcesNewTimeZone(eventSources, dateProfile, context) {\n  var activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n\n  return fetchSourcesByIds(eventSources, excludeStaticSources(eventSources, context), activeRange, true, context);\n}\n\nfunction computeEventSourcesLoading(eventSources) {\n  for (var sourceId in eventSources) {\n    if (eventSources[sourceId].isFetching) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction addSources(eventSourceHash, sources, fetchRange, context) {\n  var hash = {};\n\n  var _iterator3 = _createForOfIteratorHelper(sources),\n      _step3;\n\n  try {\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var source = _step3.value;\n      hash[source.sourceId] = source;\n    }\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n\n  if (fetchRange) {\n    hash = fetchDirtySources(hash, fetchRange, context);\n  }\n\n  return Object.assign(Object.assign({}, eventSourceHash), hash);\n}\n\nfunction removeSource(eventSourceHash, sourceId) {\n  return filterHash(eventSourceHash, function (eventSource) {\n    return eventSource.sourceId !== sourceId;\n  });\n}\n\nfunction fetchDirtySources(sourceHash, fetchRange, context) {\n  return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\n    return isSourceDirty(eventSource, fetchRange, context);\n  }), fetchRange, false, context);\n}\n\nfunction isSourceDirty(eventSource, fetchRange, context) {\n  if (!doesSourceNeedRange(eventSource, context)) {\n    return !eventSource.latestFetchId;\n  }\n\n  return !context.options.lazyFetching || !eventSource.fetchRange || eventSource.isFetching || // always cancel outdated in-progress fetches\n  fetchRange.start < eventSource.fetchRange.start || fetchRange.end > eventSource.fetchRange.end;\n}\n\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, isRefetch, context) {\n  var nextSources = {};\n\n  for (var sourceId in prevSources) {\n    var source = prevSources[sourceId];\n\n    if (sourceIdHash[sourceId]) {\n      nextSources[sourceId] = fetchSource(source, fetchRange, isRefetch, context);\n    } else {\n      nextSources[sourceId] = source;\n    }\n  }\n\n  return nextSources;\n}\n\nfunction fetchSource(eventSource, fetchRange, isRefetch, context) {\n  var options = context.options,\n      calendarApi = context.calendarApi;\n  var sourceDef = context.pluginHooks.eventSourceDefs[eventSource.sourceDefId];\n  var fetchId = guid();\n  sourceDef.fetch({\n    eventSource: eventSource,\n    range: fetchRange,\n    isRefetch: isRefetch,\n    context: context\n  }, function (res) {\n    var rawEvents = res.rawEvents;\n\n    if (options.eventSourceSuccess) {\n      rawEvents = options.eventSourceSuccess.call(calendarApi, rawEvents, res.response) || rawEvents;\n    }\n\n    if (eventSource.success) {\n      rawEvents = eventSource.success.call(calendarApi, rawEvents, res.response) || rawEvents;\n    }\n\n    context.dispatch({\n      type: 'RECEIVE_EVENTS',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      rawEvents: rawEvents\n    });\n  }, function (error) {\n    var errorHandled = false;\n\n    if (options.eventSourceFailure) {\n      options.eventSourceFailure.call(calendarApi, error);\n      errorHandled = true;\n    }\n\n    if (eventSource.failure) {\n      eventSource.failure(error);\n      errorHandled = true;\n    }\n\n    if (!errorHandled) {\n      console.warn(error.message, error);\n    }\n\n    context.dispatch({\n      type: 'RECEIVE_EVENT_ERROR',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      error: error\n    });\n  });\n  return Object.assign(Object.assign({}, eventSource), {\n    isFetching: true,\n    latestFetchId: fetchId\n  });\n}\n\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n  var eventSource = sourceHash[sourceId];\n\n  if (eventSource && // not already removed\n  fetchId === eventSource.latestFetchId) {\n    return Object.assign(Object.assign({}, sourceHash), _defineProperty({}, sourceId, Object.assign(Object.assign({}, eventSource), {\n      isFetching: false,\n      fetchRange: fetchRange\n    })));\n  }\n\n  return sourceHash;\n}\n\nfunction excludeStaticSources(eventSources, context) {\n  return filterHash(eventSources, function (eventSource) {\n    return doesSourceNeedRange(eventSource, context);\n  });\n}\n\nfunction parseInitialSources(rawOptions, context) {\n  var refiners = buildEventSourceRefiners(context);\n  var rawSources = [].concat(rawOptions.eventSources || []);\n  var sources = []; // parsed\n\n  if (rawOptions.initialEvents) {\n    rawSources.unshift(rawOptions.initialEvents);\n  }\n\n  if (rawOptions.events) {\n    rawSources.unshift(rawOptions.events);\n  }\n\n  var _iterator4 = _createForOfIteratorHelper(rawSources),\n      _step4;\n\n  try {\n    for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n      var rawSource = _step4.value;\n      var source = parseEventSource(rawSource, context, refiners);\n\n      if (source) {\n        sources.push(source);\n      }\n    }\n  } catch (err) {\n    _iterator4.e(err);\n  } finally {\n    _iterator4.f();\n  }\n\n  return sources;\n}\n\nfunction doesSourceNeedRange(eventSource, context) {\n  var defs = context.pluginHooks.eventSourceDefs;\n  return !defs[eventSource.sourceDefId].ignoreRange;\n}\n\nfunction reduceDateSelection(currentSelection, action) {\n  switch (action.type) {\n    case 'UNSELECT_DATES':\n      return null;\n\n    case 'SELECT_DATES':\n      return action.selection;\n\n    default:\n      return currentSelection;\n  }\n}\n\nfunction reduceSelectedEvent(currentInstanceId, action) {\n  switch (action.type) {\n    case 'UNSELECT_EVENT':\n      return '';\n\n    case 'SELECT_EVENT':\n      return action.eventInstanceId;\n\n    default:\n      return currentInstanceId;\n  }\n}\n\nfunction reduceEventDrag(currentDrag, action) {\n  var newDrag;\n\n  switch (action.type) {\n    case 'UNSET_EVENT_DRAG':\n      return null;\n\n    case 'SET_EVENT_DRAG':\n      newDrag = action.state;\n      return {\n        affectedEvents: newDrag.affectedEvents,\n        mutatedEvents: newDrag.mutatedEvents,\n        isEvent: newDrag.isEvent\n      };\n\n    default:\n      return currentDrag;\n  }\n}\n\nfunction reduceEventResize(currentResize, action) {\n  var newResize;\n\n  switch (action.type) {\n    case 'UNSET_EVENT_RESIZE':\n      return null;\n\n    case 'SET_EVENT_RESIZE':\n      newResize = action.state;\n      return {\n        affectedEvents: newResize.affectedEvents,\n        mutatedEvents: newResize.mutatedEvents,\n        isEvent: newResize.isEvent\n      };\n\n    default:\n      return currentResize;\n  }\n}\n\nfunction parseToolbars(calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n  var header = calendarOptions.headerToolbar ? parseToolbar(calendarOptions.headerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n  var footer = calendarOptions.footerToolbar ? parseToolbar(calendarOptions.footerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n  return {\n    header: header,\n    footer: footer\n  };\n}\n\nfunction parseToolbar(sectionStrHash, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n  var sectionWidgets = {};\n  var viewsWithButtons = [];\n  var hasTitle = false;\n\n  for (var sectionName in sectionStrHash) {\n    var sectionStr = sectionStrHash[sectionName];\n    var sectionRes = parseSection(sectionStr, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi);\n    sectionWidgets[sectionName] = sectionRes.widgets;\n    viewsWithButtons.push.apply(viewsWithButtons, _toConsumableArray(sectionRes.viewsWithButtons));\n    hasTitle = hasTitle || sectionRes.hasTitle;\n  }\n\n  return {\n    sectionWidgets: sectionWidgets,\n    viewsWithButtons: viewsWithButtons,\n    hasTitle: hasTitle\n  };\n}\n/*\nBAD: querying icons and text here. should be done at render time\n*/\n\n\nfunction parseSection(sectionStr, calendarOptions, // defaults+overrides, then refined\ncalendarOptionOverrides, // overrides only!, unrefined :(\ntheme, viewSpecs, calendarApi) {\n  var isRtl = calendarOptions.direction === 'rtl';\n  var calendarCustomButtons = calendarOptions.customButtons || {};\n  var calendarButtonTextOverrides = calendarOptionOverrides.buttonText || {};\n  var calendarButtonText = calendarOptions.buttonText || {};\n  var calendarButtonHintOverrides = calendarOptionOverrides.buttonHints || {};\n  var calendarButtonHints = calendarOptions.buttonHints || {};\n  var sectionSubstrs = sectionStr ? sectionStr.split(' ') : [];\n  var viewsWithButtons = [];\n  var hasTitle = false;\n  var widgets = sectionSubstrs.map(function (buttonGroupStr) {\n    return buttonGroupStr.split(',').map(function (buttonName) {\n      if (buttonName === 'title') {\n        hasTitle = true;\n        return {\n          buttonName: buttonName\n        };\n      }\n\n      var customButtonProps;\n      var viewSpec;\n      var buttonClick;\n      var buttonIcon; // only one of these will be set\n\n      var buttonText; // \"\n\n      var buttonHint; // ^ for the title=\"\" attribute, for accessibility\n\n      if (customButtonProps = calendarCustomButtons[buttonName]) {\n        buttonClick = function buttonClick(ev) {\n          if (customButtonProps.click) {\n            customButtonProps.click.call(ev.target, ev, ev.target); // TODO: use Calendar this context?\n          }\n        };\n\n        (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = customButtonProps.text);\n        buttonHint = customButtonProps.hint || customButtonProps.text;\n      } else if (viewSpec = viewSpecs[buttonName]) {\n        viewsWithButtons.push(buttonName);\n\n        buttonClick = function buttonClick() {\n          calendarApi.changeView(buttonName);\n        };\n\n        (buttonText = viewSpec.buttonTextOverride) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = viewSpec.buttonTextDefault);\n        var textFallback = viewSpec.buttonTextOverride || viewSpec.buttonTextDefault;\n        buttonHint = formatWithOrdinals(viewSpec.buttonTitleOverride || viewSpec.buttonTitleDefault || calendarOptions.viewHint, [textFallback, buttonName], // view-name = buttonName\n        textFallback);\n      } else if (calendarApi[buttonName]) {\n        // a calendarApi method\n        buttonClick = function buttonClick() {\n          calendarApi[buttonName]();\n        };\n\n        (buttonText = calendarButtonTextOverrides[buttonName]) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = calendarButtonText[buttonName]); // everything else is considered default\n\n        if (buttonName === 'prevYear' || buttonName === 'nextYear') {\n          var prevOrNext = buttonName === 'prevYear' ? 'prev' : 'next';\n          buttonHint = formatWithOrdinals(calendarButtonHintOverrides[prevOrNext] || calendarButtonHints[prevOrNext], [calendarButtonText.year || 'year', 'year'], calendarButtonText[buttonName]);\n        } else {\n          buttonHint = function buttonHint(navUnit) {\n            return formatWithOrdinals(calendarButtonHintOverrides[buttonName] || calendarButtonHints[buttonName], [calendarButtonText[navUnit] || navUnit, navUnit], calendarButtonText[buttonName]);\n          };\n        }\n      }\n\n      return {\n        buttonName: buttonName,\n        buttonClick: buttonClick,\n        buttonIcon: buttonIcon,\n        buttonText: buttonText,\n        buttonHint: buttonHint\n      };\n    });\n  });\n  return {\n    widgets: widgets,\n    viewsWithButtons: viewsWithButtons,\n    hasTitle: hasTitle\n  };\n} // always represents the current view. otherwise, it'd need to change value every time date changes\n\n\nvar ViewImpl = /*#__PURE__*/function () {\n  function ViewImpl(type, getCurrentData, dateEnv) {\n    _classCallCheck(this, ViewImpl);\n\n    this.type = type;\n    this.getCurrentData = getCurrentData;\n    this.dateEnv = dateEnv;\n  }\n\n  _createClass(ViewImpl, [{\n    key: \"calendar\",\n    get: function get() {\n      return this.getCurrentData().calendarApi;\n    }\n  }, {\n    key: \"title\",\n    get: function get() {\n      return this.getCurrentData().viewTitle;\n    }\n  }, {\n    key: \"activeStart\",\n    get: function get() {\n      return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start);\n    }\n  }, {\n    key: \"activeEnd\",\n    get: function get() {\n      return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end);\n    }\n  }, {\n    key: \"currentStart\",\n    get: function get() {\n      return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start);\n    }\n  }, {\n    key: \"currentEnd\",\n    get: function get() {\n      return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end);\n    }\n  }, {\n    key: \"getOption\",\n    value: function getOption(name) {\n      return this.getCurrentData().options[name]; // are the view-specific options\n    }\n  }]);\n\n  return ViewImpl;\n}();\n\nvar eventSourceDef$2 = {\n  ignoreRange: true,\n  parseMeta: function parseMeta(refined) {\n    if (Array.isArray(refined.events)) {\n      return refined.events;\n    }\n\n    return null;\n  },\n  fetch: function fetch(arg, successCallback) {\n    successCallback({\n      rawEvents: arg.eventSource.meta\n    });\n  }\n};\nvar arrayEventSourcePlugin = createPlugin({\n  name: 'array-event-source',\n  eventSourceDefs: [eventSourceDef$2]\n});\nvar eventSourceDef$1 = {\n  parseMeta: function parseMeta(refined) {\n    if (typeof refined.events === 'function') {\n      return refined.events;\n    }\n\n    return null;\n  },\n  fetch: function fetch(arg, successCallback, errorCallback) {\n    var dateEnv = arg.context.dateEnv;\n    var func = arg.eventSource.meta;\n    unpromisify(func.bind(null, buildRangeApiWithTimeZone(arg.range, dateEnv)), function (rawEvents) {\n      return successCallback({\n        rawEvents: rawEvents\n      });\n    }, errorCallback);\n  }\n};\nvar funcEventSourcePlugin = createPlugin({\n  name: 'func-event-source',\n  eventSourceDefs: [eventSourceDef$1]\n});\nvar JSON_FEED_EVENT_SOURCE_REFINERS = {\n  method: String,\n  extraParams: identity,\n  startParam: String,\n  endParam: String,\n  timeZoneParam: String\n};\nvar eventSourceDef = {\n  parseMeta: function parseMeta(refined) {\n    if (refined.url && (refined.format === 'json' || !refined.format)) {\n      return {\n        url: refined.url,\n        format: 'json',\n        method: (refined.method || 'GET').toUpperCase(),\n        extraParams: refined.extraParams,\n        startParam: refined.startParam,\n        endParam: refined.endParam,\n        timeZoneParam: refined.timeZoneParam\n      };\n    }\n\n    return null;\n  },\n  fetch: function fetch(arg, successCallback, errorCallback) {\n    var meta = arg.eventSource.meta;\n    var requestParams = buildRequestParams(meta, arg.range, arg.context);\n    requestJson(meta.method, meta.url, requestParams).then(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          rawEvents = _ref2[0],\n          response = _ref2[1];\n\n      successCallback({\n        rawEvents: rawEvents,\n        response: response\n      });\n    }, errorCallback);\n  }\n};\nvar jsonFeedEventSourcePlugin = createPlugin({\n  name: 'json-event-source',\n  eventSourceRefiners: JSON_FEED_EVENT_SOURCE_REFINERS,\n  eventSourceDefs: [eventSourceDef]\n});\n\nfunction buildRequestParams(meta, range, context) {\n  var dateEnv = context.dateEnv,\n      options = context.options;\n  var startParam;\n  var endParam;\n  var timeZoneParam;\n  var customRequestParams;\n  var params = {};\n  startParam = meta.startParam;\n\n  if (startParam == null) {\n    startParam = options.startParam;\n  }\n\n  endParam = meta.endParam;\n\n  if (endParam == null) {\n    endParam = options.endParam;\n  }\n\n  timeZoneParam = meta.timeZoneParam;\n\n  if (timeZoneParam == null) {\n    timeZoneParam = options.timeZoneParam;\n  } // retrieve any outbound GET/POST data from the options\n\n\n  if (typeof meta.extraParams === 'function') {\n    // supplied as a function that returns a key/value object\n    customRequestParams = meta.extraParams();\n  } else {\n    // probably supplied as a straight key/value object\n    customRequestParams = meta.extraParams || {};\n  }\n\n  Object.assign(params, customRequestParams);\n  params[startParam] = dateEnv.formatIso(range.start);\n  params[endParam] = dateEnv.formatIso(range.end);\n\n  if (dateEnv.timeZone !== 'local') {\n    params[timeZoneParam] = dateEnv.timeZone;\n  }\n\n  return params;\n}\n\nvar SIMPLE_RECURRING_REFINERS = {\n  daysOfWeek: identity,\n  startTime: createDuration,\n  endTime: createDuration,\n  duration: createDuration,\n  startRecur: identity,\n  endRecur: identity\n};\nvar recurring = {\n  parse: function parse(refined, dateEnv) {\n    if (refined.daysOfWeek || refined.startTime || refined.endTime || refined.startRecur || refined.endRecur) {\n      var recurringData = {\n        daysOfWeek: refined.daysOfWeek || null,\n        startTime: refined.startTime || null,\n        endTime: refined.endTime || null,\n        startRecur: refined.startRecur ? dateEnv.createMarker(refined.startRecur) : null,\n        endRecur: refined.endRecur ? dateEnv.createMarker(refined.endRecur) : null\n      };\n      var duration;\n\n      if (refined.duration) {\n        duration = refined.duration;\n      }\n\n      if (!duration && refined.startTime && refined.endTime) {\n        duration = subtractDurations(refined.endTime, refined.startTime);\n      }\n\n      return {\n        allDayGuess: Boolean(!refined.startTime && !refined.endTime),\n        duration: duration,\n        typeData: recurringData // doesn't need endTime anymore but oh well\n\n      };\n    }\n\n    return null;\n  },\n  expand: function expand(typeData, framingRange, dateEnv) {\n    var clippedFramingRange = intersectRanges(framingRange, {\n      start: typeData.startRecur,\n      end: typeData.endRecur\n    });\n\n    if (clippedFramingRange) {\n      return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n    }\n\n    return [];\n  }\n};\nvar simpleRecurringEventsPlugin = createPlugin({\n  name: 'simple-recurring-event',\n  recurringTypes: [recurring],\n  eventRefiners: SIMPLE_RECURRING_REFINERS\n});\n\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n  var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n  var dayMarker = startOfDay(framingRange.start);\n  var endMarker = framingRange.end;\n  var instanceStarts = [];\n\n  while (dayMarker < endMarker) {\n    var instanceStart = void 0; // if everyday, or this particular day-of-week\n\n    if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n      if (startTime) {\n        instanceStart = dateEnv.add(dayMarker, startTime);\n      } else {\n        instanceStart = dayMarker;\n      }\n\n      instanceStarts.push(instanceStart);\n    }\n\n    dayMarker = addDays(dayMarker, 1);\n  }\n\n  return instanceStarts;\n}\n\nvar changeHandlerPlugin = createPlugin({\n  name: 'change-handler',\n  optionChangeHandlers: {\n    events: function events(_events, context) {\n      handleEventSources([_events], context);\n    },\n    eventSources: handleEventSources\n  }\n});\n/*\nBUG: if `event` was supplied, all previously-given `eventSources` will be wiped out\n*/\n\nfunction handleEventSources(inputs, context) {\n  var unfoundSources = hashValuesToArray(context.getCurrentData().eventSources);\n\n  if (unfoundSources.length === 1 && inputs.length === 1 && Array.isArray(unfoundSources[0]._raw) && Array.isArray(inputs[0])) {\n    context.dispatch({\n      type: 'RESET_RAW_EVENTS',\n      sourceId: unfoundSources[0].sourceId,\n      rawEvents: inputs[0]\n    });\n    return;\n  }\n\n  var newInputs = [];\n\n  var _iterator5 = _createForOfIteratorHelper(inputs),\n      _step5;\n\n  try {\n    for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n      var input = _step5.value;\n      var inputFound = false;\n\n      for (var i = 0; i < unfoundSources.length; i += 1) {\n        if (unfoundSources[i]._raw === input) {\n          unfoundSources.splice(i, 1); // delete\n\n          inputFound = true;\n          break;\n        }\n      }\n\n      if (!inputFound) {\n        newInputs.push(input);\n      }\n    }\n  } catch (err) {\n    _iterator5.e(err);\n  } finally {\n    _iterator5.f();\n  }\n\n  var _iterator6 = _createForOfIteratorHelper(unfoundSources),\n      _step6;\n\n  try {\n    for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n      var unfoundSource = _step6.value;\n      context.dispatch({\n        type: 'REMOVE_EVENT_SOURCE',\n        sourceId: unfoundSource.sourceId\n      });\n    }\n  } catch (err) {\n    _iterator6.e(err);\n  } finally {\n    _iterator6.f();\n  }\n\n  for (var _i = 0, _newInputs = newInputs; _i < _newInputs.length; _i++) {\n    var newInput = _newInputs[_i];\n    context.calendarApi.addEventSource(newInput);\n  }\n}\n\nfunction handleDateProfile(dateProfile, context) {\n  context.emitter.trigger('datesSet', Object.assign(Object.assign({}, buildRangeApiWithTimeZone(dateProfile.activeRange, context.dateEnv)), {\n    view: context.viewApi\n  }));\n}\n\nfunction handleEventStore(eventStore, context) {\n  var emitter = context.emitter;\n\n  if (emitter.hasHandlers('eventsSet')) {\n    emitter.trigger('eventsSet', buildEventApis(eventStore, context));\n  }\n}\n/*\nthis array is exposed on the root namespace so that UMD plugins can add to it.\nsee the rollup-bundles script.\n*/\n\n\nvar globalPlugins = [arrayEventSourcePlugin, funcEventSourcePlugin, jsonFeedEventSourcePlugin, simpleRecurringEventsPlugin, changeHandlerPlugin, createPlugin({\n  name: 'misc',\n  isLoadingFuncs: [function (state) {\n    return computeEventSourcesLoading(state.eventSources);\n  }],\n  propSetHandlers: {\n    dateProfile: handleDateProfile,\n    eventStore: handleEventStore\n  }\n})];\n\nvar TaskRunner = /*#__PURE__*/function () {\n  function TaskRunner(runTaskOption, drainedOption) {\n    _classCallCheck(this, TaskRunner);\n\n    this.runTaskOption = runTaskOption;\n    this.drainedOption = drainedOption;\n    this.queue = [];\n    this.delayedRunner = new DelayedRunner(this.drain.bind(this));\n  }\n\n  _createClass(TaskRunner, [{\n    key: \"request\",\n    value: function request(task, delay) {\n      this.queue.push(task);\n      this.delayedRunner.request(delay);\n    }\n  }, {\n    key: \"pause\",\n    value: function pause(scope) {\n      this.delayedRunner.pause(scope);\n    }\n  }, {\n    key: \"resume\",\n    value: function resume(scope, force) {\n      this.delayedRunner.resume(scope, force);\n    }\n  }, {\n    key: \"drain\",\n    value: function drain() {\n      var queue = this.queue;\n\n      while (queue.length) {\n        var completedTasks = [];\n        var task = void 0;\n\n        while (task = queue.shift()) {\n          this.runTask(task);\n          completedTasks.push(task);\n        }\n\n        this.drained(completedTasks);\n      } // keep going, in case new tasks were added in the drained handler\n\n    }\n  }, {\n    key: \"runTask\",\n    value: function runTask(task) {\n      if (this.runTaskOption) {\n        this.runTaskOption(task);\n      }\n    }\n  }, {\n    key: \"drained\",\n    value: function drained(completedTasks) {\n      if (this.drainedOption) {\n        this.drainedOption(completedTasks);\n      }\n    }\n  }]);\n\n  return TaskRunner;\n}(); // Computes what the title at the top of the calendarApi should be for this view\n\n\nfunction buildTitle(dateProfile, viewOptions, dateEnv) {\n  var range; // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n\n  if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n    range = dateProfile.currentRange;\n  } else {\n    // for day units or smaller, use the actual day range\n    range = dateProfile.activeRange;\n  }\n\n  return dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || buildTitleFormat(dateProfile)), {\n    isEndExclusive: dateProfile.isRangeAllDay,\n    defaultSeparator: viewOptions.titleRangeSeparator\n  });\n} // Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\n\n\nfunction buildTitleFormat(dateProfile) {\n  var currentRangeUnit = dateProfile.currentRangeUnit;\n\n  if (currentRangeUnit === 'year') {\n    return {\n      year: 'numeric'\n    };\n  }\n\n  if (currentRangeUnit === 'month') {\n    return {\n      year: 'numeric',\n      month: 'long'\n    }; // like \"September 2014\"\n  }\n\n  var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n\n  if (days !== null && days > 1) {\n    // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n    return {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    };\n  } // one day. longer, like \"September 9 2014\"\n\n\n  return {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  };\n} // in future refactor, do the redux-style function(state=initial) for initial-state\n// also, whatever is happening in constructor, have it happen in action queue too\n\n\nvar CalendarDataManager = /*#__PURE__*/function () {\n  function CalendarDataManager(props) {\n    var _this = this;\n\n    _classCallCheck(this, CalendarDataManager);\n\n    this.computeCurrentViewData = memoize(this._computeCurrentViewData);\n    this.organizeRawLocales = memoize(organizeRawLocales);\n    this.buildLocale = memoize(buildLocale);\n    this.buildPluginHooks = buildBuildPluginHooks();\n    this.buildDateEnv = memoize(buildDateEnv$1);\n    this.buildTheme = memoize(buildTheme);\n    this.parseToolbars = memoize(parseToolbars);\n    this.buildViewSpecs = memoize(buildViewSpecs);\n    this.buildDateProfileGenerator = memoizeObjArg(buildDateProfileGenerator);\n    this.buildViewApi = memoize(buildViewApi);\n    this.buildViewUiProps = memoizeObjArg(buildViewUiProps);\n    this.buildEventUiBySource = memoize(buildEventUiBySource, isPropsEqual);\n    this.buildEventUiBases = memoize(buildEventUiBases);\n    this.parseContextBusinessHours = memoizeObjArg(parseContextBusinessHours);\n    this.buildTitle = memoize(buildTitle);\n    this.emitter = new Emitter();\n    this.actionRunner = new TaskRunner(this._handleAction.bind(this), this.updateData.bind(this));\n    this.currentCalendarOptionsInput = {};\n    this.currentCalendarOptionsRefined = {};\n    this.currentViewOptionsInput = {};\n    this.currentViewOptionsRefined = {};\n    this.currentCalendarOptionsRefiners = {};\n    this.optionsForRefining = [];\n    this.optionsForHandling = [];\n\n    this.getCurrentData = function () {\n      return _this.data;\n    };\n\n    this.dispatch = function (action) {\n      _this.actionRunner.request(action); // protects against recursive calls to _handleAction\n\n    };\n\n    this.props = props;\n    this.actionRunner.pause();\n    var dynamicOptionOverrides = {};\n    var optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n    var currentViewType = optionsData.calendarOptions.initialView || optionsData.pluginHooks.initialView;\n    var currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides); // wire things up\n    // TODO: not DRY\n\n    props.calendarApi.currentDataManager = this;\n    this.emitter.setThisContext(props.calendarApi);\n    this.emitter.setOptions(currentViewData.options);\n    var currentDate = getInitialDate(optionsData.calendarOptions, optionsData.dateEnv);\n    var dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n\n    if (!rangeContainsMarker(dateProfile.activeRange, currentDate)) {\n      currentDate = dateProfile.currentRange.start;\n    }\n\n    var calendarContext = {\n      dateEnv: optionsData.dateEnv,\n      options: optionsData.calendarOptions,\n      pluginHooks: optionsData.pluginHooks,\n      calendarApi: props.calendarApi,\n      dispatch: this.dispatch,\n      emitter: this.emitter,\n      getCurrentData: this.getCurrentData\n    }; // needs to be after setThisContext\n\n    var _iterator7 = _createForOfIteratorHelper(optionsData.pluginHooks.contextInit),\n        _step7;\n\n    try {\n      for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n        var callback = _step7.value;\n        callback(calendarContext);\n      } // NOT DRY\n\n    } catch (err) {\n      _iterator7.e(err);\n    } finally {\n      _iterator7.f();\n    }\n\n    var eventSources = initEventSources(optionsData.calendarOptions, dateProfile, calendarContext);\n    var initialState = {\n      dynamicOptionOverrides: dynamicOptionOverrides,\n      currentViewType: currentViewType,\n      currentDate: currentDate,\n      dateProfile: dateProfile,\n      businessHours: this.parseContextBusinessHours(calendarContext),\n      eventSources: eventSources,\n      eventUiBases: {},\n      eventStore: createEmptyEventStore(),\n      renderableEventStore: createEmptyEventStore(),\n      dateSelection: null,\n      eventSelection: '',\n      eventDrag: null,\n      eventResize: null,\n      selectionConfig: this.buildViewUiProps(calendarContext).selectionConfig\n    };\n    var contextAndState = Object.assign(Object.assign({}, calendarContext), initialState);\n\n    var _iterator8 = _createForOfIteratorHelper(optionsData.pluginHooks.reducers),\n        _step8;\n\n    try {\n      for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n        var reducer = _step8.value;\n        Object.assign(initialState, reducer(null, null, contextAndState));\n      }\n    } catch (err) {\n      _iterator8.e(err);\n    } finally {\n      _iterator8.f();\n    }\n\n    if (computeIsLoading(initialState, calendarContext)) {\n      this.emitter.trigger('loading', true); // NOT DRY\n    }\n\n    this.state = initialState;\n    this.updateData();\n    this.actionRunner.resume();\n  }\n\n  _createClass(CalendarDataManager, [{\n    key: \"resetOptions\",\n    value: function resetOptions(optionOverrides, changedOptionNames) {\n      var props = this.props;\n\n      if (changedOptionNames === undefined) {\n        props.optionOverrides = optionOverrides;\n      } else {\n        var _this$optionsForRefin;\n\n        props.optionOverrides = Object.assign(Object.assign({}, props.optionOverrides || {}), optionOverrides);\n\n        (_this$optionsForRefin = this.optionsForRefining).push.apply(_this$optionsForRefin, _toConsumableArray(changedOptionNames));\n      }\n\n      if (changedOptionNames === undefined || changedOptionNames.length) {\n        this.actionRunner.request({\n          type: 'NOTHING'\n        });\n      }\n    }\n  }, {\n    key: \"_handleAction\",\n    value: function _handleAction(action) {\n      var props = this.props,\n          state = this.state,\n          emitter = this.emitter;\n      var dynamicOptionOverrides = reduceDynamicOptionOverrides(state.dynamicOptionOverrides, action);\n      var optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n      var currentViewType = reduceViewType(state.currentViewType, action);\n      var currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides); // wire things up\n      // TODO: not DRY\n\n      props.calendarApi.currentDataManager = this;\n      emitter.setThisContext(props.calendarApi);\n      emitter.setOptions(currentViewData.options);\n      var calendarContext = {\n        dateEnv: optionsData.dateEnv,\n        options: optionsData.calendarOptions,\n        pluginHooks: optionsData.pluginHooks,\n        calendarApi: props.calendarApi,\n        dispatch: this.dispatch,\n        emitter: emitter,\n        getCurrentData: this.getCurrentData\n      };\n      var currentDate = state.currentDate,\n          dateProfile = state.dateProfile;\n\n      if (this.data && this.data.dateProfileGenerator !== currentViewData.dateProfileGenerator) {\n        // hack\n        dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n      }\n\n      currentDate = reduceCurrentDate(currentDate, action);\n      dateProfile = reduceDateProfile(dateProfile, action, currentDate, currentViewData.dateProfileGenerator);\n\n      if (action.type === 'PREV' || // TODO: move this logic into DateProfileGenerator\n      action.type === 'NEXT' || // \"\n      !rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n        currentDate = dateProfile.currentRange.start;\n      }\n\n      var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendarContext);\n      var eventStore = reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendarContext);\n      var isEventsLoading = computeEventSourcesLoading(eventSources); // BAD. also called in this func in computeIsLoading\n\n      var renderableEventStore = isEventsLoading && !currentViewData.options.progressiveEventRendering ? state.renderableEventStore || eventStore : // try from previous state\n      eventStore;\n\n      var _this$buildViewUiProp = this.buildViewUiProps(calendarContext),\n          eventUiSingleBase = _this$buildViewUiProp.eventUiSingleBase,\n          selectionConfig = _this$buildViewUiProp.selectionConfig; // will memoize obj\n\n\n      var eventUiBySource = this.buildEventUiBySource(eventSources);\n      var eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n      var newState = {\n        dynamicOptionOverrides: dynamicOptionOverrides,\n        currentViewType: currentViewType,\n        currentDate: currentDate,\n        dateProfile: dateProfile,\n        eventSources: eventSources,\n        eventStore: eventStore,\n        renderableEventStore: renderableEventStore,\n        selectionConfig: selectionConfig,\n        eventUiBases: eventUiBases,\n        businessHours: this.parseContextBusinessHours(calendarContext),\n        dateSelection: reduceDateSelection(state.dateSelection, action),\n        eventSelection: reduceSelectedEvent(state.eventSelection, action),\n        eventDrag: reduceEventDrag(state.eventDrag, action),\n        eventResize: reduceEventResize(state.eventResize, action)\n      };\n      var contextAndState = Object.assign(Object.assign({}, calendarContext), newState);\n\n      var _iterator9 = _createForOfIteratorHelper(optionsData.pluginHooks.reducers),\n          _step9;\n\n      try {\n        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n          var reducer = _step9.value;\n          Object.assign(newState, reducer(state, action, contextAndState)); // give the OLD state, for old value\n        }\n      } catch (err) {\n        _iterator9.e(err);\n      } finally {\n        _iterator9.f();\n      }\n\n      var wasLoading = computeIsLoading(state, calendarContext);\n      var isLoading = computeIsLoading(newState, calendarContext); // TODO: use propSetHandlers in plugin system\n\n      if (!wasLoading && isLoading) {\n        emitter.trigger('loading', true);\n      } else if (wasLoading && !isLoading) {\n        emitter.trigger('loading', false);\n      }\n\n      this.state = newState;\n\n      if (props.onAction) {\n        props.onAction(action);\n      }\n    }\n  }, {\n    key: \"updateData\",\n    value: function updateData() {\n      var props = this.props,\n          state = this.state;\n      var oldData = this.data;\n      var optionsData = this.computeOptionsData(props.optionOverrides, state.dynamicOptionOverrides, props.calendarApi);\n      var currentViewData = this.computeCurrentViewData(state.currentViewType, optionsData, props.optionOverrides, state.dynamicOptionOverrides);\n      var data = this.data = Object.assign(Object.assign(Object.assign({\n        viewTitle: this.buildTitle(state.dateProfile, currentViewData.options, optionsData.dateEnv),\n        calendarApi: props.calendarApi,\n        dispatch: this.dispatch,\n        emitter: this.emitter,\n        getCurrentData: this.getCurrentData\n      }, optionsData), currentViewData), state);\n      var changeHandlers = optionsData.pluginHooks.optionChangeHandlers;\n      var oldCalendarOptions = oldData && oldData.calendarOptions;\n      var newCalendarOptions = optionsData.calendarOptions;\n\n      if (oldCalendarOptions && oldCalendarOptions !== newCalendarOptions) {\n        if (oldCalendarOptions.timeZone !== newCalendarOptions.timeZone) {\n          // hack\n          state.eventSources = data.eventSources = reduceEventSourcesNewTimeZone(data.eventSources, state.dateProfile, data);\n          state.eventStore = data.eventStore = rezoneEventStoreDates(data.eventStore, oldData.dateEnv, data.dateEnv);\n          state.renderableEventStore = data.renderableEventStore = rezoneEventStoreDates(data.renderableEventStore, oldData.dateEnv, data.dateEnv);\n        }\n\n        for (var optionName in changeHandlers) {\n          if (this.optionsForHandling.indexOf(optionName) !== -1 || oldCalendarOptions[optionName] !== newCalendarOptions[optionName]) {\n            changeHandlers[optionName](newCalendarOptions[optionName], data);\n          }\n        }\n      }\n\n      this.optionsForHandling = [];\n\n      if (props.onData) {\n        props.onData(data);\n      }\n    }\n  }, {\n    key: \"computeOptionsData\",\n    value: function computeOptionsData(optionOverrides, dynamicOptionOverrides, calendarApi) {\n      // TODO: blacklist options that are handled by optionChangeHandlers\n      if (!this.optionsForRefining.length && optionOverrides === this.stableOptionOverrides && dynamicOptionOverrides === this.stableDynamicOptionOverrides) {\n        return this.stableCalendarOptionsData;\n      }\n\n      var _this$processRawCalen = this.processRawCalendarOptions(optionOverrides, dynamicOptionOverrides),\n          refinedOptions = _this$processRawCalen.refinedOptions,\n          pluginHooks = _this$processRawCalen.pluginHooks,\n          localeDefaults = _this$processRawCalen.localeDefaults,\n          availableLocaleData = _this$processRawCalen.availableLocaleData,\n          extra = _this$processRawCalen.extra;\n\n      warnUnknownOptions(extra);\n      var dateEnv = this.buildDateEnv(refinedOptions.timeZone, refinedOptions.locale, refinedOptions.weekNumberCalculation, refinedOptions.firstDay, refinedOptions.weekText, pluginHooks, availableLocaleData, refinedOptions.defaultRangeSeparator);\n      var viewSpecs = this.buildViewSpecs(pluginHooks.views, this.stableOptionOverrides, this.stableDynamicOptionOverrides, localeDefaults);\n      var theme = this.buildTheme(refinedOptions, pluginHooks);\n      var toolbarConfig = this.parseToolbars(refinedOptions, this.stableOptionOverrides, theme, viewSpecs, calendarApi);\n      return this.stableCalendarOptionsData = {\n        calendarOptions: refinedOptions,\n        pluginHooks: pluginHooks,\n        dateEnv: dateEnv,\n        viewSpecs: viewSpecs,\n        theme: theme,\n        toolbarConfig: toolbarConfig,\n        localeDefaults: localeDefaults,\n        availableRawLocales: availableLocaleData.map\n      };\n    } // always called from behind a memoizer\n\n  }, {\n    key: \"processRawCalendarOptions\",\n    value: function processRawCalendarOptions(optionOverrides, dynamicOptionOverrides) {\n      var _this$optionsForHandl;\n\n      var _mergeRawOptions = mergeRawOptions([BASE_OPTION_DEFAULTS, optionOverrides, dynamicOptionOverrides]),\n          locales = _mergeRawOptions.locales,\n          locale = _mergeRawOptions.locale;\n\n      var availableLocaleData = this.organizeRawLocales(locales);\n      var availableRawLocales = availableLocaleData.map;\n      var localeDefaults = this.buildLocale(locale || availableLocaleData.defaultCode, availableRawLocales).options;\n      var pluginHooks = this.buildPluginHooks(optionOverrides.plugins || [], globalPlugins);\n      var refiners = this.currentCalendarOptionsRefiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n      var extra = {};\n      var raw = mergeRawOptions([BASE_OPTION_DEFAULTS, localeDefaults, optionOverrides, dynamicOptionOverrides]);\n      var refined = {};\n      var currentRaw = this.currentCalendarOptionsInput;\n      var currentRefined = this.currentCalendarOptionsRefined;\n      var anyChanges = false;\n\n      for (var optionName in raw) {\n        if (this.optionsForRefining.indexOf(optionName) === -1 && (raw[optionName] === currentRaw[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && optionName in currentRaw && COMPLEX_OPTION_COMPARATORS[optionName](currentRaw[optionName], raw[optionName]))) {\n          refined[optionName] = currentRefined[optionName];\n        } else if (refiners[optionName]) {\n          refined[optionName] = refiners[optionName](raw[optionName]);\n          anyChanges = true;\n        } else {\n          extra[optionName] = currentRaw[optionName];\n        }\n      }\n\n      if (anyChanges) {\n        this.currentCalendarOptionsInput = raw;\n        this.currentCalendarOptionsRefined = refined;\n        this.stableOptionOverrides = optionOverrides;\n        this.stableDynamicOptionOverrides = dynamicOptionOverrides;\n      }\n\n      (_this$optionsForHandl = this.optionsForHandling).push.apply(_this$optionsForHandl, _toConsumableArray(this.optionsForRefining));\n\n      this.optionsForRefining = [];\n      return {\n        rawOptions: this.currentCalendarOptionsInput,\n        refinedOptions: this.currentCalendarOptionsRefined,\n        pluginHooks: pluginHooks,\n        availableLocaleData: availableLocaleData,\n        localeDefaults: localeDefaults,\n        extra: extra\n      };\n    }\n  }, {\n    key: \"_computeCurrentViewData\",\n    value: function _computeCurrentViewData(viewType, optionsData, optionOverrides, dynamicOptionOverrides) {\n      var viewSpec = optionsData.viewSpecs[viewType];\n\n      if (!viewSpec) {\n        throw new Error(\"viewType \\\"\".concat(viewType, \"\\\" is not available. Please make sure you've loaded all neccessary plugins\"));\n      }\n\n      var _this$processRawViewO = this.processRawViewOptions(viewSpec, optionsData.pluginHooks, optionsData.localeDefaults, optionOverrides, dynamicOptionOverrides),\n          refinedOptions = _this$processRawViewO.refinedOptions,\n          extra = _this$processRawViewO.extra;\n\n      warnUnknownOptions(extra);\n      var dateProfileGenerator = this.buildDateProfileGenerator({\n        dateProfileGeneratorClass: viewSpec.optionDefaults.dateProfileGeneratorClass,\n        duration: viewSpec.duration,\n        durationUnit: viewSpec.durationUnit,\n        usesMinMaxTime: viewSpec.optionDefaults.usesMinMaxTime,\n        dateEnv: optionsData.dateEnv,\n        calendarApi: this.props.calendarApi,\n        slotMinTime: refinedOptions.slotMinTime,\n        slotMaxTime: refinedOptions.slotMaxTime,\n        showNonCurrentDates: refinedOptions.showNonCurrentDates,\n        dayCount: refinedOptions.dayCount,\n        dateAlignment: refinedOptions.dateAlignment,\n        dateIncrement: refinedOptions.dateIncrement,\n        hiddenDays: refinedOptions.hiddenDays,\n        weekends: refinedOptions.weekends,\n        nowInput: refinedOptions.now,\n        validRangeInput: refinedOptions.validRange,\n        visibleRangeInput: refinedOptions.visibleRange,\n        fixedWeekCount: refinedOptions.fixedWeekCount\n      });\n      var viewApi = this.buildViewApi(viewType, this.getCurrentData, optionsData.dateEnv);\n      return {\n        viewSpec: viewSpec,\n        options: refinedOptions,\n        dateProfileGenerator: dateProfileGenerator,\n        viewApi: viewApi\n      };\n    }\n  }, {\n    key: \"processRawViewOptions\",\n    value: function processRawViewOptions(viewSpec, pluginHooks, localeDefaults, optionOverrides, dynamicOptionOverrides) {\n      var raw = mergeRawOptions([BASE_OPTION_DEFAULTS, viewSpec.optionDefaults, localeDefaults, optionOverrides, viewSpec.optionOverrides, dynamicOptionOverrides]);\n      var refiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), VIEW_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n      var refined = {};\n      var currentRaw = this.currentViewOptionsInput;\n      var currentRefined = this.currentViewOptionsRefined;\n      var anyChanges = false;\n      var extra = {};\n\n      for (var optionName in raw) {\n        if (raw[optionName] === currentRaw[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], currentRaw[optionName])) {\n          refined[optionName] = currentRefined[optionName];\n        } else {\n          if (raw[optionName] === this.currentCalendarOptionsInput[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], this.currentCalendarOptionsInput[optionName])) {\n            if (optionName in this.currentCalendarOptionsRefined) {\n              // might be an \"extra\" prop\n              refined[optionName] = this.currentCalendarOptionsRefined[optionName];\n            }\n          } else if (refiners[optionName]) {\n            refined[optionName] = refiners[optionName](raw[optionName]);\n          } else {\n            extra[optionName] = raw[optionName];\n          }\n\n          anyChanges = true;\n        }\n      }\n\n      if (anyChanges) {\n        this.currentViewOptionsInput = raw;\n        this.currentViewOptionsRefined = refined;\n      }\n\n      return {\n        rawOptions: this.currentViewOptionsInput,\n        refinedOptions: this.currentViewOptionsRefined,\n        extra: extra\n      };\n    }\n  }]);\n\n  return CalendarDataManager;\n}();\n\nfunction buildDateEnv$1(timeZone, explicitLocale, weekNumberCalculation, firstDay, weekText, pluginHooks, availableLocaleData, defaultSeparator) {\n  var locale = buildLocale(explicitLocale || availableLocaleData.defaultCode, availableLocaleData.map);\n  return new DateEnv({\n    calendarSystem: 'gregory',\n    timeZone: timeZone,\n    namedTimeZoneImpl: pluginHooks.namedTimeZonedImpl,\n    locale: locale,\n    weekNumberCalculation: weekNumberCalculation,\n    firstDay: firstDay,\n    weekText: weekText,\n    cmdFormatter: pluginHooks.cmdFormatter,\n    defaultSeparator: defaultSeparator\n  });\n}\n\nfunction buildTheme(options, pluginHooks) {\n  var ThemeClass = pluginHooks.themeClasses[options.themeSystem] || StandardTheme;\n  return new ThemeClass(options);\n}\n\nfunction buildDateProfileGenerator(props) {\n  var DateProfileGeneratorClass = props.dateProfileGeneratorClass || DateProfileGenerator;\n  return new DateProfileGeneratorClass(props);\n}\n\nfunction buildViewApi(type, getCurrentData, dateEnv) {\n  return new ViewImpl(type, getCurrentData, dateEnv);\n}\n\nfunction buildEventUiBySource(eventSources) {\n  return mapHash(eventSources, function (eventSource) {\n    return eventSource.ui;\n  });\n}\n\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n  var eventUiBases = {\n    '': eventUiSingleBase\n  };\n\n  for (var defId in eventDefs) {\n    var def = eventDefs[defId];\n\n    if (def.sourceId && eventUiBySource[def.sourceId]) {\n      eventUiBases[defId] = eventUiBySource[def.sourceId];\n    }\n  }\n\n  return eventUiBases;\n}\n\nfunction buildViewUiProps(calendarContext) {\n  var options = calendarContext.options;\n  return {\n    eventUiSingleBase: createEventUi({\n      display: options.eventDisplay,\n      editable: options.editable,\n      startEditable: options.eventStartEditable,\n      durationEditable: options.eventDurationEditable,\n      constraint: options.eventConstraint,\n      overlap: typeof options.eventOverlap === 'boolean' ? options.eventOverlap : undefined,\n      allow: options.eventAllow,\n      backgroundColor: options.eventBackgroundColor,\n      borderColor: options.eventBorderColor,\n      textColor: options.eventTextColor,\n      color: options.eventColor // classNames: options.eventClassNames // render hook will handle this\n\n    }, calendarContext),\n    selectionConfig: createEventUi({\n      constraint: options.selectConstraint,\n      overlap: typeof options.selectOverlap === 'boolean' ? options.selectOverlap : undefined,\n      allow: options.selectAllow\n    }, calendarContext)\n  };\n}\n\nfunction computeIsLoading(state, context) {\n  var _iterator10 = _createForOfIteratorHelper(context.pluginHooks.isLoadingFuncs),\n      _step10;\n\n  try {\n    for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n      var isLoadingFunc = _step10.value;\n\n      if (isLoadingFunc(state)) {\n        return true;\n      }\n    }\n  } catch (err) {\n    _iterator10.e(err);\n  } finally {\n    _iterator10.f();\n  }\n\n  return false;\n}\n\nfunction parseContextBusinessHours(calendarContext) {\n  return parseBusinessHours(calendarContext.options.businessHours, calendarContext);\n}\n\nfunction warnUnknownOptions(options, viewName) {\n  for (var optionName in options) {\n    console.warn(\"Unknown option '\".concat(optionName, \"'\") + (viewName ? \" for view '\".concat(viewName, \"'\") : ''));\n  }\n}\n\nvar ToolbarSection = /*#__PURE__*/function (_BaseComponent) {\n  _inherits(ToolbarSection, _BaseComponent);\n\n  var _super2 = _createSuper(ToolbarSection);\n\n  function ToolbarSection() {\n    _classCallCheck(this, ToolbarSection);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(ToolbarSection, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var children = this.props.widgetGroups.map(function (widgetGroup) {\n        return _this2.renderWidgetGroup(widgetGroup);\n      });\n      return createElement.apply(void 0, ['div', {\n        className: 'fc-toolbar-chunk'\n      }].concat(_toConsumableArray(children)));\n    }\n  }, {\n    key: \"renderWidgetGroup\",\n    value: function renderWidgetGroup(widgetGroup) {\n      var props = this.props;\n      var theme = this.context.theme;\n      var children = [];\n      var isOnlyButtons = true;\n\n      var _iterator11 = _createForOfIteratorHelper(widgetGroup),\n          _step11;\n\n      try {\n        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n          var widget = _step11.value;\n          var buttonName = widget.buttonName,\n              buttonClick = widget.buttonClick,\n              buttonText = widget.buttonText,\n              buttonIcon = widget.buttonIcon,\n              buttonHint = widget.buttonHint;\n\n          if (buttonName === 'title') {\n            isOnlyButtons = false;\n            children.push(createElement(\"h2\", {\n              className: \"fc-toolbar-title\",\n              id: props.titleId\n            }, props.title));\n          } else {\n            var isPressed = buttonName === props.activeButton;\n            var isDisabled = !props.isTodayEnabled && buttonName === 'today' || !props.isPrevEnabled && buttonName === 'prev' || !props.isNextEnabled && buttonName === 'next';\n            var buttonClasses = [\"fc-\".concat(buttonName, \"-button\"), theme.getClass('button')];\n\n            if (isPressed) {\n              buttonClasses.push(theme.getClass('buttonActive'));\n            }\n\n            children.push(createElement(\"button\", {\n              type: \"button\",\n              title: typeof buttonHint === 'function' ? buttonHint(props.navUnit) : buttonHint,\n              disabled: isDisabled,\n              \"aria-pressed\": isPressed,\n              className: buttonClasses.join(' '),\n              onClick: buttonClick\n            }, buttonText || (buttonIcon ? createElement(\"span\", {\n              className: buttonIcon,\n              role: \"img\"\n            }) : '')));\n          }\n        }\n      } catch (err) {\n        _iterator11.e(err);\n      } finally {\n        _iterator11.f();\n      }\n\n      if (children.length > 1) {\n        var groupClassName = isOnlyButtons && theme.getClass('buttonGroup') || '';\n        return createElement.apply(void 0, ['div', {\n          className: groupClassName\n        }].concat(children));\n      }\n\n      return children[0];\n    }\n  }]);\n\n  return ToolbarSection;\n}(BaseComponent);\n\nvar Toolbar = /*#__PURE__*/function (_BaseComponent2) {\n  _inherits(Toolbar, _BaseComponent2);\n\n  var _super3 = _createSuper(Toolbar);\n\n  function Toolbar() {\n    _classCallCheck(this, Toolbar);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Toolbar, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          model = _this$props.model,\n          extraClassName = _this$props.extraClassName;\n      var forceLtr = false;\n      var startContent;\n      var endContent;\n      var sectionWidgets = model.sectionWidgets;\n      var centerContent = sectionWidgets.center;\n\n      if (sectionWidgets.left) {\n        forceLtr = true;\n        startContent = sectionWidgets.left;\n      } else {\n        startContent = sectionWidgets.start;\n      }\n\n      if (sectionWidgets.right) {\n        forceLtr = true;\n        endContent = sectionWidgets.right;\n      } else {\n        endContent = sectionWidgets.end;\n      }\n\n      var classNames = [extraClassName || '', 'fc-toolbar', forceLtr ? 'fc-toolbar-ltr' : ''];\n      return createElement(\"div\", {\n        className: classNames.join(' ')\n      }, this.renderSection('start', startContent || []), this.renderSection('center', centerContent || []), this.renderSection('end', endContent || []));\n    }\n  }, {\n    key: \"renderSection\",\n    value: function renderSection(key, widgetGroups) {\n      var props = this.props;\n      return createElement(ToolbarSection, {\n        key: key,\n        widgetGroups: widgetGroups,\n        title: props.title,\n        navUnit: props.navUnit,\n        activeButton: props.activeButton,\n        isTodayEnabled: props.isTodayEnabled,\n        isPrevEnabled: props.isPrevEnabled,\n        isNextEnabled: props.isNextEnabled,\n        titleId: props.titleId\n      });\n    }\n  }]);\n\n  return Toolbar;\n}(BaseComponent);\n\nvar ViewHarness = /*#__PURE__*/function (_BaseComponent3) {\n  _inherits(ViewHarness, _BaseComponent3);\n\n  var _super4 = _createSuper(ViewHarness);\n\n  function ViewHarness() {\n    var _this3;\n\n    _classCallCheck(this, ViewHarness);\n\n    _this3 = _super4.apply(this, arguments);\n    _this3.state = {\n      availableWidth: null\n    };\n\n    _this3.handleEl = function (el) {\n      _this3.el = el;\n      setRef(_this3.props.elRef, el);\n\n      _this3.updateAvailableWidth();\n    };\n\n    _this3.handleResize = function () {\n      _this3.updateAvailableWidth();\n    };\n\n    return _this3;\n  }\n\n  _createClass(ViewHarness, [{\n    key: \"render\",\n    value: function render() {\n      var props = this.props,\n          state = this.state;\n      var aspectRatio = props.aspectRatio;\n      var classNames = ['fc-view-harness', aspectRatio || props.liquid || props.height ? 'fc-view-harness-active' // harness controls the height\n      : 'fc-view-harness-passive' // let the view do the height\n      ];\n      var height = '';\n      var paddingBottom = '';\n\n      if (aspectRatio) {\n        if (state.availableWidth !== null) {\n          height = state.availableWidth / aspectRatio;\n        } else {\n          // while waiting to know availableWidth, we can't set height to *zero*\n          // because will cause lots of unnecessary scrollbars within scrollgrid.\n          // BETTER: don't start rendering ANYTHING yet until we know container width\n          // NOTE: why not always use paddingBottom? Causes height oscillation (issue 5606)\n          paddingBottom = \"\".concat(1 / aspectRatio * 100, \"%\");\n        }\n      } else {\n        height = props.height || '';\n      }\n\n      return createElement(\"div\", {\n        \"aria-labelledby\": props.labeledById,\n        ref: this.handleEl,\n        className: classNames.join(' '),\n        style: {\n          height: height,\n          paddingBottom: paddingBottom\n        }\n      }, props.children);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.context.addResizeHandler(this.handleResize);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.context.removeResizeHandler(this.handleResize);\n    }\n  }, {\n    key: \"updateAvailableWidth\",\n    value: function updateAvailableWidth() {\n      if (this.el && // needed. but why?\n      this.props.aspectRatio // aspectRatio is the only height setting that needs availableWidth\n      ) {\n        this.setState({\n          availableWidth: this.el.offsetWidth\n        });\n      }\n    }\n  }]);\n\n  return ViewHarness;\n}(BaseComponent);\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\n\n\nvar EventClicking = /*#__PURE__*/function (_Interaction) {\n  _inherits(EventClicking, _Interaction);\n\n  var _super5 = _createSuper(EventClicking);\n\n  function EventClicking(settings) {\n    var _this4;\n\n    _classCallCheck(this, EventClicking);\n\n    _this4 = _super5.call(this, settings);\n\n    _this4.handleSegClick = function (ev, segEl) {\n      var _assertThisInitialize = _assertThisInitialized(_this4),\n          component = _assertThisInitialize.component;\n\n      var context = component.context;\n      var seg = getElSeg(segEl);\n\n      if (seg && // might be the <div> surrounding the more link\n      component.isValidSegDownEl(ev.target)) {\n        // our way to simulate a link click for elements that can't be <a> tags\n        // grab before trigger fired in case trigger trashes DOM thru rerendering\n        var hasUrlContainer = elementClosest(ev.target, '.fc-event-forced-url');\n        var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n        context.emitter.trigger('eventClick', {\n          el: segEl,\n          event: new EventImpl(component.context, seg.eventRange.def, seg.eventRange.instance),\n          jsEvent: ev,\n          view: context.viewApi\n        });\n\n        if (url && !ev.defaultPrevented) {\n          window.location.href = url;\n        }\n      }\n    };\n\n    _this4.destroy = listenBySelector(settings.el, 'click', '.fc-event', // on both fg and bg events\n    _this4.handleSegClick);\n    return _this4;\n  }\n\n  return _createClass(EventClicking);\n}(Interaction);\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\n\n\nvar EventHovering = /*#__PURE__*/function (_Interaction2) {\n  _inherits(EventHovering, _Interaction2);\n\n  var _super6 = _createSuper(EventHovering);\n\n  function EventHovering(settings) {\n    var _this5;\n\n    _classCallCheck(this, EventHovering);\n\n    _this5 = _super6.call(this, settings); // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n\n    _this5.handleEventElRemove = function (el) {\n      if (el === _this5.currentSegEl) {\n        _this5.handleSegLeave(null, _this5.currentSegEl);\n      }\n    };\n\n    _this5.handleSegEnter = function (ev, segEl) {\n      if (getElSeg(segEl)) {\n        // TODO: better way to make sure not hovering over more+ link or its wrapper\n        _this5.currentSegEl = segEl;\n\n        _this5.triggerEvent('eventMouseEnter', ev, segEl);\n      }\n    };\n\n    _this5.handleSegLeave = function (ev, segEl) {\n      if (_this5.currentSegEl) {\n        _this5.currentSegEl = null;\n\n        _this5.triggerEvent('eventMouseLeave', ev, segEl);\n      }\n    };\n\n    _this5.removeHoverListeners = listenToHoverBySelector(settings.el, '.fc-event', // on both fg and bg events\n    _this5.handleSegEnter, _this5.handleSegLeave);\n    return _this5;\n  }\n\n  _createClass(EventHovering, [{\n    key: \"destroy\",\n    value: function destroy() {\n      this.removeHoverListeners();\n    }\n  }, {\n    key: \"triggerEvent\",\n    value: function triggerEvent(publicEvName, ev, segEl) {\n      var component = this.component;\n      var context = component.context;\n      var seg = getElSeg(segEl);\n\n      if (!ev || component.isValidSegDownEl(ev.target)) {\n        context.emitter.trigger(publicEvName, {\n          el: segEl,\n          event: new EventImpl(context, seg.eventRange.def, seg.eventRange.instance),\n          jsEvent: ev,\n          view: context.viewApi\n        });\n      }\n    }\n  }]);\n\n  return EventHovering;\n}(Interaction);\n\nvar CalendarContent = /*#__PURE__*/function (_PureComponent) {\n  _inherits(CalendarContent, _PureComponent);\n\n  var _super7 = _createSuper(CalendarContent);\n\n  function CalendarContent() {\n    var _this6;\n\n    _classCallCheck(this, CalendarContent);\n\n    _this6 = _super7.apply(this, arguments);\n    _this6.buildViewContext = memoize(buildViewContext);\n    _this6.buildViewPropTransformers = memoize(buildViewPropTransformers);\n    _this6.buildToolbarProps = memoize(buildToolbarProps);\n    _this6.headerRef = createRef();\n    _this6.footerRef = createRef();\n    _this6.interactionsStore = {}; // eslint-disable-next-line\n\n    _this6.state = {\n      viewLabelId: getUniqueDomId()\n    }; // Component Registration\n    // -----------------------------------------------------------------------------------------------------------------\n\n    _this6.registerInteractiveComponent = function (component, settingsInput) {\n      var settings = parseInteractionSettings(component, settingsInput);\n      var DEFAULT_INTERACTIONS = [EventClicking, EventHovering];\n      var interactionClasses = DEFAULT_INTERACTIONS.concat(_this6.props.pluginHooks.componentInteractions);\n      var interactions = interactionClasses.map(function (TheInteractionClass) {\n        return new TheInteractionClass(settings);\n      });\n      _this6.interactionsStore[component.uid] = interactions;\n      interactionSettingsStore[component.uid] = settings;\n    };\n\n    _this6.unregisterInteractiveComponent = function (component) {\n      var listeners = _this6.interactionsStore[component.uid];\n\n      if (listeners) {\n        var _iterator12 = _createForOfIteratorHelper(listeners),\n            _step12;\n\n        try {\n          for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n            var listener = _step12.value;\n            listener.destroy();\n          }\n        } catch (err) {\n          _iterator12.e(err);\n        } finally {\n          _iterator12.f();\n        }\n\n        delete _this6.interactionsStore[component.uid];\n      }\n\n      delete interactionSettingsStore[component.uid];\n    }; // Resizing\n    // -----------------------------------------------------------------------------------------------------------------\n\n\n    _this6.resizeRunner = new DelayedRunner(function () {\n      _this6.props.emitter.trigger('_resize', true); // should window resizes be considered \"forced\" ?\n\n\n      _this6.props.emitter.trigger('windowResize', {\n        view: _this6.props.viewApi\n      });\n    });\n\n    _this6.handleWindowResize = function (ev) {\n      var options = _this6.props.options;\n\n      if (options.handleWindowResize && ev.target === window // avoid jqui events\n      ) {\n        _this6.resizeRunner.request(options.windowResizeDelay);\n      }\n    };\n\n    return _this6;\n  }\n  /*\n  renders INSIDE of an outer div\n  */\n\n\n  _createClass(CalendarContent, [{\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var toolbarConfig = props.toolbarConfig,\n          options = props.options;\n      var toolbarProps = this.buildToolbarProps(props.viewSpec, props.dateProfile, props.dateProfileGenerator, props.currentDate, getNow(props.options.now, props.dateEnv), // TODO: use NowTimer????\n      props.viewTitle);\n      var viewVGrow = false;\n      var viewHeight = '';\n      var viewAspectRatio;\n\n      if (props.isHeightAuto || props.forPrint) {\n        viewHeight = '';\n      } else if (options.height != null) {\n        viewVGrow = true;\n      } else if (options.contentHeight != null) {\n        viewHeight = options.contentHeight;\n      } else {\n        viewAspectRatio = Math.max(options.aspectRatio, 0.5); // prevent from getting too tall\n      }\n\n      var viewContext = this.buildViewContext(props.viewSpec, props.viewApi, props.options, props.dateProfileGenerator, props.dateEnv, props.theme, props.pluginHooks, props.dispatch, props.getCurrentData, props.emitter, props.calendarApi, this.registerInteractiveComponent, this.unregisterInteractiveComponent);\n      var viewLabelId = toolbarConfig.header && toolbarConfig.header.hasTitle ? this.state.viewLabelId : undefined;\n      return createElement(ViewContextType.Provider, {\n        value: viewContext\n      }, toolbarConfig.header && createElement(Toolbar, Object.assign({\n        ref: this.headerRef,\n        extraClassName: \"fc-header-toolbar\",\n        model: toolbarConfig.header,\n        titleId: viewLabelId\n      }, toolbarProps)), createElement(ViewHarness, {\n        liquid: viewVGrow,\n        height: viewHeight,\n        aspectRatio: viewAspectRatio,\n        labeledById: viewLabelId\n      }, this.renderView(props), this.buildAppendContent()), toolbarConfig.footer && createElement(Toolbar, Object.assign({\n        ref: this.footerRef,\n        extraClassName: \"fc-footer-toolbar\",\n        model: toolbarConfig.footer,\n        titleId: \"\"\n      }, toolbarProps)));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var props = this.props;\n      this.calendarInteractions = props.pluginHooks.calendarInteractions.map(function (CalendarInteractionClass) {\n        return new CalendarInteractionClass(props);\n      });\n      window.addEventListener('resize', this.handleWindowResize);\n      var propSetHandlers = props.pluginHooks.propSetHandlers;\n\n      for (var propName in propSetHandlers) {\n        propSetHandlers[propName](props[propName], props);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var props = this.props;\n      var propSetHandlers = props.pluginHooks.propSetHandlers;\n\n      for (var propName in propSetHandlers) {\n        if (props[propName] !== prevProps[propName]) {\n          propSetHandlers[propName](props[propName], props);\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.handleWindowResize);\n      this.resizeRunner.clear();\n\n      var _iterator13 = _createForOfIteratorHelper(this.calendarInteractions),\n          _step13;\n\n      try {\n        for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {\n          var interaction = _step13.value;\n          interaction.destroy();\n        }\n      } catch (err) {\n        _iterator13.e(err);\n      } finally {\n        _iterator13.f();\n      }\n\n      this.props.emitter.trigger('_unmount');\n    }\n  }, {\n    key: \"buildAppendContent\",\n    value: function buildAppendContent() {\n      var props = this.props;\n      var children = props.pluginHooks.viewContainerAppends.map(function (buildAppendContent) {\n        return buildAppendContent(props);\n      });\n      return createElement.apply(void 0, [Fragment, {}].concat(_toConsumableArray(children)));\n    }\n  }, {\n    key: \"renderView\",\n    value: function renderView(props) {\n      var pluginHooks = props.pluginHooks;\n      var viewSpec = props.viewSpec;\n      var viewProps = {\n        dateProfile: props.dateProfile,\n        businessHours: props.businessHours,\n        eventStore: props.renderableEventStore,\n        eventUiBases: props.eventUiBases,\n        dateSelection: props.dateSelection,\n        eventSelection: props.eventSelection,\n        eventDrag: props.eventDrag,\n        eventResize: props.eventResize,\n        isHeightAuto: props.isHeightAuto,\n        forPrint: props.forPrint\n      };\n      var transformers = this.buildViewPropTransformers(pluginHooks.viewPropsTransformers);\n\n      var _iterator14 = _createForOfIteratorHelper(transformers),\n          _step14;\n\n      try {\n        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {\n          var transformer = _step14.value;\n          Object.assign(viewProps, transformer.transform(viewProps, props));\n        }\n      } catch (err) {\n        _iterator14.e(err);\n      } finally {\n        _iterator14.f();\n      }\n\n      var ViewComponent = viewSpec.component;\n      return createElement(ViewComponent, Object.assign({}, viewProps));\n    }\n  }]);\n\n  return CalendarContent;\n}(PureComponent);\n\nfunction buildToolbarProps(viewSpec, dateProfile, dateProfileGenerator, currentDate, now, title) {\n  // don't force any date-profiles to valid date profiles (the `false`) so that we can tell if it's invalid\n  var todayInfo = dateProfileGenerator.build(now, undefined, false); // TODO: need `undefined` or else INFINITE LOOP for some reason\n\n  var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate, false);\n  var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate, false);\n  return {\n    title: title,\n    activeButton: viewSpec.type,\n    navUnit: viewSpec.singleUnit,\n    isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n    isPrevEnabled: prevInfo.isValid,\n    isNextEnabled: nextInfo.isValid\n  };\n} // Plugin\n// -----------------------------------------------------------------------------------------------------------------\n\n\nfunction buildViewPropTransformers(theClasses) {\n  return theClasses.map(function (TheClass) {\n    return new TheClass();\n  });\n}\n\nvar Calendar = /*#__PURE__*/function (_CalendarImpl) {\n  _inherits(Calendar, _CalendarImpl);\n\n  var _super8 = _createSuper(Calendar);\n\n  function Calendar(el) {\n    var _this7;\n\n    var optionOverrides = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Calendar);\n\n    _this7 = _super8.call(this);\n    _this7.isRendering = false;\n    _this7.isRendered = false;\n    _this7.currentClassNames = [];\n    _this7.customContentRenderId = 0;\n\n    _this7.handleAction = function (action) {\n      // actions we know we want to render immediately\n      switch (action.type) {\n        case 'SET_EVENT_DRAG':\n        case 'SET_EVENT_RESIZE':\n          _this7.renderRunner.tryDrain();\n\n      }\n    };\n\n    _this7.handleData = function (data) {\n      _this7.currentData = data;\n\n      _this7.renderRunner.request(data.calendarOptions.rerenderDelay);\n    };\n\n    _this7.handleRenderRequest = function () {\n      if (_this7.isRendering) {\n        _this7.isRendered = true;\n\n        var _assertThisInitialize2 = _assertThisInitialized(_this7),\n            currentData = _assertThisInitialize2.currentData;\n\n        flushSync(function () {\n          render(createElement(CalendarRoot, {\n            options: currentData.calendarOptions,\n            theme: currentData.theme,\n            emitter: currentData.emitter\n          }, function (classNames, height, isHeightAuto, forPrint) {\n            _this7.setClassNames(classNames);\n\n            _this7.setHeight(height);\n\n            return createElement(RenderId.Provider, {\n              value: _this7.customContentRenderId\n            }, createElement(CalendarContent, Object.assign({\n              isHeightAuto: isHeightAuto,\n              forPrint: forPrint\n            }, currentData)));\n          }), _this7.el);\n        });\n      } else if (_this7.isRendered) {\n        _this7.isRendered = false;\n        render(null, _this7.el);\n\n        _this7.setClassNames([]);\n\n        _this7.setHeight('');\n      }\n    };\n\n    ensureElHasStyles(el);\n    _this7.el = el;\n    _this7.renderRunner = new DelayedRunner(_this7.handleRenderRequest);\n    new CalendarDataManager({\n      optionOverrides: optionOverrides,\n      calendarApi: _assertThisInitialized(_this7),\n      onAction: _this7.handleAction,\n      onData: _this7.handleData\n    });\n    return _this7;\n  }\n\n  _createClass(Calendar, [{\n    key: \"render\",\n    value: function render() {\n      var wasRendering = this.isRendering;\n\n      if (!wasRendering) {\n        this.isRendering = true;\n      } else {\n        this.customContentRenderId += 1;\n      }\n\n      this.renderRunner.request();\n\n      if (wasRendering) {\n        this.updateSize();\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.isRendering) {\n        this.isRendering = false;\n        this.renderRunner.request();\n      }\n    }\n  }, {\n    key: \"updateSize\",\n    value: function updateSize() {\n      var _this8 = this;\n\n      flushSync(function () {\n        _get(_getPrototypeOf(Calendar.prototype), \"updateSize\", _this8).call(_this8);\n      });\n    }\n  }, {\n    key: \"batchRendering\",\n    value: function batchRendering(func) {\n      this.renderRunner.pause('batchRendering');\n      func();\n      this.renderRunner.resume('batchRendering');\n    }\n  }, {\n    key: \"pauseRendering\",\n    value: function pauseRendering() {\n      this.renderRunner.pause('pauseRendering');\n    }\n  }, {\n    key: \"resumeRendering\",\n    value: function resumeRendering() {\n      this.renderRunner.resume('pauseRendering', true);\n    }\n  }, {\n    key: \"resetOptions\",\n    value: function resetOptions(optionOverrides, changedOptionNames) {\n      this.currentDataManager.resetOptions(optionOverrides, changedOptionNames);\n    }\n  }, {\n    key: \"setClassNames\",\n    value: function setClassNames(classNames) {\n      if (!isArraysEqual(classNames, this.currentClassNames)) {\n        var classList = this.el.classList;\n\n        var _iterator15 = _createForOfIteratorHelper(this.currentClassNames),\n            _step15;\n\n        try {\n          for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {\n            var className = _step15.value;\n            classList.remove(className);\n          }\n        } catch (err) {\n          _iterator15.e(err);\n        } finally {\n          _iterator15.f();\n        }\n\n        var _iterator16 = _createForOfIteratorHelper(classNames),\n            _step16;\n\n        try {\n          for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {\n            var _className = _step16.value;\n            classList.add(_className);\n          }\n        } catch (err) {\n          _iterator16.e(err);\n        } finally {\n          _iterator16.f();\n        }\n\n        this.currentClassNames = classNames;\n      }\n    }\n  }, {\n    key: \"setHeight\",\n    value: function setHeight(height) {\n      applyStyleProp(this.el, 'height', height);\n    }\n  }]);\n\n  return Calendar;\n}(CalendarImpl);\n\nfunction formatDate(dateInput) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var dateEnv = buildDateEnv(options);\n  var formatter = createFormatter(options);\n  var dateMeta = dateEnv.createMarkerMeta(dateInput);\n\n  if (!dateMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.format(dateMeta.marker, formatter, {\n    forcedTzo: dateMeta.forcedTzo\n  });\n}\n\nfunction formatRange(startInput, endInput, options) {\n  var dateEnv = buildDateEnv(typeof options === 'object' && options ? options : {}); // pass in if non-null object\n\n  var formatter = createFormatter(options);\n  var startMeta = dateEnv.createMarkerMeta(startInput);\n  var endMeta = dateEnv.createMarkerMeta(endInput);\n\n  if (!startMeta || !endMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n    forcedStartTzo: startMeta.forcedTzo,\n    forcedEndTzo: endMeta.forcedTzo,\n    isEndExclusive: options.isEndExclusive,\n    defaultSeparator: BASE_OPTION_DEFAULTS.defaultRangeSeparator\n  });\n} // TODO: more DRY and optimized\n\n\nfunction buildDateEnv(settings) {\n  var locale = buildLocale(settings.locale || 'en', organizeRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n\n  return new DateEnv(Object.assign(Object.assign({\n    timeZone: BASE_OPTION_DEFAULTS.timeZone,\n    calendarSystem: 'gregory'\n  }, settings), {\n    locale: locale\n  }));\n} // HELPERS\n\n/*\nif nextDayThreshold is specified, slicing is done in an all-day fashion.\nyou can get nextDayThreshold from context.nextDayThreshold\n*/\n\n\nfunction sliceEvents(props, allDay) {\n  return sliceEventStore(props.eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? props.nextDayThreshold : null).fg;\n}\n\nvar version = '6.1.11';\nexport { Calendar, createPlugin, formatDate, formatRange, globalLocales, globalPlugins, sliceEvents, version };","map":{"version":3,"names":["m","mergeProps","g","guid","i","isArraysEqual","T","Theme","a","mapHash","B","BaseComponent","V","ViewContextType","C","ContentContainer","b","buildViewClassNames","c","greatestDurationDenominator","d","createDuration","e","BASE_OPTION_DEFAULTS","f","arrayToHash","h","filterHash","j","buildEventSourceRefiners","p","parseEventSource","k","formatWithOrdinals","u","unpromisify","l","buildRangeApiWithTimeZone","n","identity","r","requestJson","s","subtractDurations","o","intersectRanges","q","startOfDay","t","addDays","v","hashValuesToArray","w","buildEventApis","D","DelayedRunner","x","createFormatter","y","diffWholeDays","z","memoize","A","memoizeObjArg","E","isPropsEqual","F","Emitter","G","getInitialDate","H","rangeContainsMarker","I","createEmptyEventStore","J","reduceCurrentDate","K","reduceEventStore","L","rezoneEventStoreDates","M","mergeRawOptions","N","BASE_OPTION_REFINERS","O","CALENDAR_LISTENER_REFINERS","P","CALENDAR_OPTION_REFINERS","Q","COMPLEX_OPTION_COMPARATORS","R","VIEW_OPTION_REFINERS","S","DateEnv","U","DateProfileGenerator","W","createEventUi","X","parseBusinessHours","Y","setRef","Z","Interaction","_","getElSeg","$","elementClosest","a0","EventImpl","a1","listenBySelector","a2","listenToHoverBySelector","a3","PureComponent","a4","buildViewContext","a5","getUniqueDomId","a6","parseInteractionSettings","a7","interactionSettingsStore","a8","getNow","a9","CalendarImpl","aa","flushSync","ab","CalendarRoot","ac","RenderId","ad","ensureElHasStyles","ae","applyStyleProp","af","sliceEventStore","ag","JsonRequestError","createElement","createRef","Fragment","render","globalLocales","MINIMAL_RAW_EN_LOCALE","code","week","dow","doy","direction","buttonText","prev","next","prevYear","nextYear","year","today","month","day","list","weekText","weekTextLong","closeHint","timeHint","eventHint","allDayText","moreLinkText","noEventsText","RAW_EN_LOCALE","Object","assign","buttonHints","unit","viewHint","navLinkHint","moreLinkHint","eventCnt","organizeRawLocales","explicitRawLocales","defaultCode","length","allRawLocales","concat","rawLocaleMap","en","rawLocale","map","buildLocale","inputSingular","available","Array","isArray","parseLocale","queryLocale","codeArg","codes","raw","queryRawLocale","parts","toLocaleLowerCase","split","simpleId","slice","join","merged","simpleNumberFormat","Intl","NumberFormat","options","createPlugin","input","id","name","premiumReleaseDate","Date","undefined","deps","reducers","isLoadingFuncs","contextInit","eventRefiners","eventDefMemberAdders","eventSourceRefiners","isDraggableTransformers","eventDragMutationMassagers","eventDefMutationAppliers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","views","viewPropsTransformers","isPropsValid","externalDefTransforms","viewContainerAppends","eventDropTransformers","componentInteractions","calendarInteractions","themeClasses","eventSourceDefs","cmdFormatter","recurringTypes","namedTimeZonedImpl","initialView","elementDraggingImpl","optionChangeHandlers","scrollGridImpl","listenerRefiners","optionRefiners","propSetHandlers","buildPluginHooks","pluginDefs","globalDefs","currentPluginIds","hooks","addDefs","defs","def","pluginName","currentId","combineHooks","console","warn","buildBuildPluginHooks","currentOverrideDefs","currentGlobalDefs","currentHooks","overrideDefs","hooks0","hooks1","compareOptionalDates","date0","date1","Math","max","valueOf","StandardTheme","prototype","classes","root","tableCellShaded","buttonGroup","button","buttonActive","baseIconClass","iconClasses","close","rtlIconClasses","iconOverrideOption","iconOverrideCustomButtonOption","iconOverridePrefix","compileViewDefs","defaultConfigs","overrideConfigs","hash","viewType","ensureViewDef","viewDef","buildViewDef","defaultConfig","overrideConfig","queryProp","theComponent","superType","superDef","Error","component","type","defaults","rawOptions","overrides","parseViewConfigs","inputs","parseViewConfig","content","createViewHookComponent","viewProps","Consumer","context","elTag","elClasses","viewSpec","renderProps","nextDayThreshold","generatorName","customGenerator","classNameGenerator","classNames","didMount","willUnmount","buildViewSpecs","defaultInputs","optionOverrides","dynamicOptionOverrides","localeDefaults","viewDefs","buildViewSpec","durationInput","duration","durationUnit","singleUnit","singleUnitOverrides","createDurationCached","denom","value","queryButtonText","optionsSubset","buttonTextMap","buttonTextKey","queryButtonTitle","buttonKey","optionDefaults","buttonTextOverride","buttonTextDefault","buttonTitleOverride","buttonHint","buttonTitleDefault","durationInputMap","json","JSON","stringify","res","reduceViewType","action","reduceDynamicOptionOverrides","optionName","rawOptionValue","reduceDateProfile","currentDateProfile","currentDate","dateProfileGenerator","dp","build","dateMarker","buildPrev","isValid","buildNext","initEventSources","calendarOptions","dateProfile","activeRange","addSources","parseInitialSources","reduceEventSources","eventSources","sources","removeSource","sourceId","fetchDirtySources","fetchSourcesByIds","sourceIds","excludeStaticSources","isRefetch","receiveResponse","fetchId","fetchRange","reduceEventSourcesNewTimeZone","computeEventSourcesLoading","isFetching","eventSourceHash","source","eventSource","sourceHash","isSourceDirty","doesSourceNeedRange","latestFetchId","lazyFetching","start","end","prevSources","sourceIdHash","nextSources","fetchSource","calendarApi","sourceDef","pluginHooks","sourceDefId","fetch","range","rawEvents","eventSourceSuccess","call","response","success","dispatch","error","errorHandled","eventSourceFailure","failure","message","refiners","rawSources","initialEvents","unshift","events","rawSource","push","ignoreRange","reduceDateSelection","currentSelection","selection","reduceSelectedEvent","currentInstanceId","eventInstanceId","reduceEventDrag","currentDrag","newDrag","state","affectedEvents","mutatedEvents","isEvent","reduceEventResize","currentResize","newResize","parseToolbars","calendarOptionOverrides","theme","viewSpecs","header","headerToolbar","parseToolbar","footer","footerToolbar","sectionStrHash","sectionWidgets","viewsWithButtons","hasTitle","sectionName","sectionStr","sectionRes","parseSection","widgets","isRtl","calendarCustomButtons","customButtons","calendarButtonTextOverrides","calendarButtonText","calendarButtonHintOverrides","calendarButtonHints","sectionSubstrs","buttonGroupStr","buttonName","customButtonProps","buttonClick","buttonIcon","ev","click","target","getCustomButtonIconClass","getIconClass","text","hint","changeView","textFallback","prevOrNext","navUnit","ViewImpl","getCurrentData","dateEnv","viewTitle","toDate","currentRange","eventSourceDef$2","parseMeta","refined","arg","successCallback","meta","arrayEventSourcePlugin","eventSourceDef$1","errorCallback","func","bind","funcEventSourcePlugin","JSON_FEED_EVENT_SOURCE_REFINERS","method","String","extraParams","startParam","endParam","timeZoneParam","eventSourceDef","url","format","toUpperCase","requestParams","buildRequestParams","then","jsonFeedEventSourcePlugin","customRequestParams","params","formatIso","timeZone","SIMPLE_RECURRING_REFINERS","daysOfWeek","startTime","endTime","startRecur","endRecur","recurring","parse","recurringData","createMarker","allDayGuess","Boolean","typeData","expand","framingRange","clippedFramingRange","expandRanges","simpleRecurringEventsPlugin","dowHash","dayMarker","endMarker","instanceStarts","instanceStart","getUTCDay","add","changeHandlerPlugin","handleEventSources","unfoundSources","_raw","newInputs","inputFound","splice","unfoundSource","newInput","addEventSource","handleDateProfile","emitter","trigger","view","viewApi","handleEventStore","eventStore","hasHandlers","globalPlugins","TaskRunner","runTaskOption","drainedOption","queue","delayedRunner","drain","task","delay","request","scope","pause","force","resume","completedTasks","shift","runTask","drained","buildTitle","viewOptions","test","currentRangeUnit","formatRange","titleFormat","buildTitleFormat","isEndExclusive","isRangeAllDay","defaultSeparator","titleRangeSeparator","days","CalendarDataManager","props","computeCurrentViewData","_computeCurrentViewData","buildDateEnv","buildDateEnv$1","buildTheme","buildDateProfileGenerator","buildViewApi","buildViewUiProps","buildEventUiBySource","buildEventUiBases","parseContextBusinessHours","actionRunner","_handleAction","updateData","currentCalendarOptionsInput","currentCalendarOptionsRefined","currentViewOptionsInput","currentViewOptionsRefined","currentCalendarOptionsRefiners","optionsForRefining","optionsForHandling","data","optionsData","computeOptionsData","currentViewType","currentViewData","currentDataManager","setThisContext","setOptions","calendarContext","callback","initialState","businessHours","eventUiBases","renderableEventStore","dateSelection","eventSelection","eventDrag","eventResize","selectionConfig","contextAndState","reducer","computeIsLoading","changedOptionNames","isEventsLoading","progressiveEventRendering","eventUiSingleBase","eventUiBySource","newState","wasLoading","isLoading","onAction","oldData","changeHandlers","oldCalendarOptions","newCalendarOptions","indexOf","onData","stableOptionOverrides","stableDynamicOptionOverrides","stableCalendarOptionsData","processRawCalendarOptions","refinedOptions","availableLocaleData","extra","warnUnknownOptions","locale","weekNumberCalculation","firstDay","defaultRangeSeparator","toolbarConfig","availableRawLocales","locales","plugins","currentRaw","currentRefined","anyChanges","processRawViewOptions","dateProfileGeneratorClass","usesMinMaxTime","slotMinTime","slotMaxTime","showNonCurrentDates","dayCount","dateAlignment","dateIncrement","hiddenDays","weekends","nowInput","now","validRangeInput","validRange","visibleRangeInput","visibleRange","fixedWeekCount","explicitLocale","calendarSystem","namedTimeZoneImpl","ThemeClass","themeSystem","DateProfileGeneratorClass","ui","eventDefs","defId","display","eventDisplay","editable","startEditable","eventStartEditable","durationEditable","eventDurationEditable","constraint","eventConstraint","overlap","eventOverlap","allow","eventAllow","backgroundColor","eventBackgroundColor","borderColor","eventBorderColor","textColor","eventTextColor","color","eventColor","selectConstraint","selectOverlap","selectAllow","isLoadingFunc","viewName","ToolbarSection","children","widgetGroups","widgetGroup","renderWidgetGroup","className","isOnlyButtons","widget","titleId","title","isPressed","activeButton","isDisabled","isTodayEnabled","isPrevEnabled","isNextEnabled","buttonClasses","getClass","disabled","onClick","role","groupClassName","Toolbar","model","extraClassName","forceLtr","startContent","endContent","centerContent","center","left","right","renderSection","key","ViewHarness","arguments","availableWidth","handleEl","el","elRef","updateAvailableWidth","handleResize","aspectRatio","liquid","height","paddingBottom","labeledById","ref","style","addResizeHandler","removeResizeHandler","setState","offsetWidth","EventClicking","settings","handleSegClick","segEl","seg","isValidSegDownEl","hasUrlContainer","querySelector","href","event","eventRange","instance","jsEvent","defaultPrevented","window","location","destroy","EventHovering","handleEventElRemove","currentSegEl","handleSegLeave","handleSegEnter","triggerEvent","removeHoverListeners","publicEvName","CalendarContent","buildViewPropTransformers","buildToolbarProps","headerRef","footerRef","interactionsStore","viewLabelId","registerInteractiveComponent","settingsInput","DEFAULT_INTERACTIONS","interactionClasses","interactions","TheInteractionClass","uid","unregisterInteractiveComponent","listeners","listener","resizeRunner","handleWindowResize","windowResizeDelay","toolbarProps","viewVGrow","viewHeight","viewAspectRatio","isHeightAuto","forPrint","contentHeight","viewContext","Provider","renderView","buildAppendContent","CalendarInteractionClass","addEventListener","propName","prevProps","removeEventListener","clear","interaction","transformers","transformer","transform","ViewComponent","todayInfo","prevInfo","nextInfo","theClasses","TheClass","Calendar","isRendering","isRendered","currentClassNames","customContentRenderId","handleAction","renderRunner","tryDrain","handleData","currentData","rerenderDelay","handleRenderRequest","setClassNames","setHeight","wasRendering","updateSize","resetOptions","classList","remove","formatDate","dateInput","formatter","dateMeta","createMarkerMeta","marker","forcedTzo","startInput","endInput","startMeta","endMeta","forcedStartTzo","forcedEndTzo","sliceEvents","allDay","fg","version"],"sources":["C:/Users/MSI/Desktop/pfe/yas/angular/node_modules/@fullcalendar/core/index.js"],"sourcesContent":["import { m as mergeProps, g as guid, i as isArraysEqual, T as Theme, a as mapHash, B as BaseComponent, V as ViewContextType, C as ContentContainer, b as buildViewClassNames, c as greatestDurationDenominator, d as createDuration, e as BASE_OPTION_DEFAULTS, f as arrayToHash, h as filterHash, j as buildEventSourceRefiners, p as parseEventSource, k as formatWithOrdinals, u as unpromisify, l as buildRangeApiWithTimeZone, n as identity, r as requestJson, s as subtractDurations, o as intersectRanges, q as startOfDay, t as addDays, v as hashValuesToArray, w as buildEventApis, D as DelayedRunner, x as createFormatter, y as diffWholeDays, z as memoize, A as memoizeObjArg, E as isPropsEqual, F as Emitter, G as getInitialDate, H as rangeContainsMarker, I as createEmptyEventStore, J as reduceCurrentDate, K as reduceEventStore, L as rezoneEventStoreDates, M as mergeRawOptions, N as BASE_OPTION_REFINERS, O as CALENDAR_LISTENER_REFINERS, P as CALENDAR_OPTION_REFINERS, Q as COMPLEX_OPTION_COMPARATORS, R as VIEW_OPTION_REFINERS, S as DateEnv, U as DateProfileGenerator, W as createEventUi, X as parseBusinessHours, Y as setRef, Z as Interaction, _ as getElSeg, $ as elementClosest, a0 as EventImpl, a1 as listenBySelector, a2 as listenToHoverBySelector, a3 as PureComponent, a4 as buildViewContext, a5 as getUniqueDomId, a6 as parseInteractionSettings, a7 as interactionSettingsStore, a8 as getNow, a9 as CalendarImpl, aa as flushSync, ab as CalendarRoot, ac as RenderId, ad as ensureElHasStyles, ae as applyStyleProp, af as sliceEventStore } from './internal-common.js';\nexport { ag as JsonRequestError } from './internal-common.js';\nimport { createElement, createRef, Fragment, render } from 'preact';\nimport 'preact/compat';\n\nconst globalLocales = [];\n\nconst MINIMAL_RAW_EN_LOCALE = {\n    code: 'en',\n    week: {\n        dow: 0,\n        doy: 4, // 4 days need to be within the year to be considered the first week\n    },\n    direction: 'ltr',\n    buttonText: {\n        prev: 'prev',\n        next: 'next',\n        prevYear: 'prev year',\n        nextYear: 'next year',\n        year: 'year',\n        today: 'today',\n        month: 'month',\n        week: 'week',\n        day: 'day',\n        list: 'list',\n    },\n    weekText: 'W',\n    weekTextLong: 'Week',\n    closeHint: 'Close',\n    timeHint: 'Time',\n    eventHint: 'Event',\n    allDayText: 'all-day',\n    moreLinkText: 'more',\n    noEventsText: 'No events to display',\n};\nconst RAW_EN_LOCALE = Object.assign(Object.assign({}, MINIMAL_RAW_EN_LOCALE), { \n    // Includes things we don't want other locales to inherit,\n    // things that derive from other translatable strings.\n    buttonHints: {\n        prev: 'Previous $0',\n        next: 'Next $0',\n        today(buttonText, unit) {\n            return (unit === 'day')\n                ? 'Today'\n                : `This ${buttonText}`;\n        },\n    }, viewHint: '$0 view', navLinkHint: 'Go to $0', moreLinkHint(eventCnt) {\n        return `Show ${eventCnt} more event${eventCnt === 1 ? '' : 's'}`;\n    } });\nfunction organizeRawLocales(explicitRawLocales) {\n    let defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n    let allRawLocales = globalLocales.concat(explicitRawLocales);\n    let rawLocaleMap = {\n        en: RAW_EN_LOCALE,\n    };\n    for (let rawLocale of allRawLocales) {\n        rawLocaleMap[rawLocale.code] = rawLocale;\n    }\n    return {\n        map: rawLocaleMap,\n        defaultCode,\n    };\n}\nfunction buildLocale(inputSingular, available) {\n    if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n        return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n    }\n    return queryLocale(inputSingular, available);\n}\nfunction queryLocale(codeArg, available) {\n    let codes = [].concat(codeArg || []); // will convert to array\n    let raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n    return parseLocale(codeArg, codes, raw);\n}\nfunction queryRawLocale(codes, available) {\n    for (let i = 0; i < codes.length; i += 1) {\n        let parts = codes[i].toLocaleLowerCase().split('-');\n        for (let j = parts.length; j > 0; j -= 1) {\n            let simpleId = parts.slice(0, j).join('-');\n            if (available[simpleId]) {\n                return available[simpleId];\n            }\n        }\n    }\n    return null;\n}\nfunction parseLocale(codeArg, codes, raw) {\n    let merged = mergeProps([MINIMAL_RAW_EN_LOCALE, raw], ['buttonText']);\n    delete merged.code; // don't want this part of the options\n    let { week } = merged;\n    delete merged.week;\n    return {\n        codeArg,\n        codes,\n        week,\n        simpleNumberFormat: new Intl.NumberFormat(codeArg),\n        options: merged,\n    };\n}\n\n// TODO: easier way to add new hooks? need to update a million things\nfunction createPlugin(input) {\n    return {\n        id: guid(),\n        name: input.name,\n        premiumReleaseDate: input.premiumReleaseDate ? new Date(input.premiumReleaseDate) : undefined,\n        deps: input.deps || [],\n        reducers: input.reducers || [],\n        isLoadingFuncs: input.isLoadingFuncs || [],\n        contextInit: [].concat(input.contextInit || []),\n        eventRefiners: input.eventRefiners || {},\n        eventDefMemberAdders: input.eventDefMemberAdders || [],\n        eventSourceRefiners: input.eventSourceRefiners || {},\n        isDraggableTransformers: input.isDraggableTransformers || [],\n        eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n        eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n        dateSelectionTransformers: input.dateSelectionTransformers || [],\n        datePointTransforms: input.datePointTransforms || [],\n        dateSpanTransforms: input.dateSpanTransforms || [],\n        views: input.views || {},\n        viewPropsTransformers: input.viewPropsTransformers || [],\n        isPropsValid: input.isPropsValid || null,\n        externalDefTransforms: input.externalDefTransforms || [],\n        viewContainerAppends: input.viewContainerAppends || [],\n        eventDropTransformers: input.eventDropTransformers || [],\n        componentInteractions: input.componentInteractions || [],\n        calendarInteractions: input.calendarInteractions || [],\n        themeClasses: input.themeClasses || {},\n        eventSourceDefs: input.eventSourceDefs || [],\n        cmdFormatter: input.cmdFormatter,\n        recurringTypes: input.recurringTypes || [],\n        namedTimeZonedImpl: input.namedTimeZonedImpl,\n        initialView: input.initialView || '',\n        elementDraggingImpl: input.elementDraggingImpl,\n        optionChangeHandlers: input.optionChangeHandlers || {},\n        scrollGridImpl: input.scrollGridImpl || null,\n        listenerRefiners: input.listenerRefiners || {},\n        optionRefiners: input.optionRefiners || {},\n        propSetHandlers: input.propSetHandlers || {},\n    };\n}\nfunction buildPluginHooks(pluginDefs, globalDefs) {\n    let currentPluginIds = {};\n    let hooks = {\n        premiumReleaseDate: undefined,\n        reducers: [],\n        isLoadingFuncs: [],\n        contextInit: [],\n        eventRefiners: {},\n        eventDefMemberAdders: [],\n        eventSourceRefiners: {},\n        isDraggableTransformers: [],\n        eventDragMutationMassagers: [],\n        eventDefMutationAppliers: [],\n        dateSelectionTransformers: [],\n        datePointTransforms: [],\n        dateSpanTransforms: [],\n        views: {},\n        viewPropsTransformers: [],\n        isPropsValid: null,\n        externalDefTransforms: [],\n        viewContainerAppends: [],\n        eventDropTransformers: [],\n        componentInteractions: [],\n        calendarInteractions: [],\n        themeClasses: {},\n        eventSourceDefs: [],\n        cmdFormatter: null,\n        recurringTypes: [],\n        namedTimeZonedImpl: null,\n        initialView: '',\n        elementDraggingImpl: null,\n        optionChangeHandlers: {},\n        scrollGridImpl: null,\n        listenerRefiners: {},\n        optionRefiners: {},\n        propSetHandlers: {},\n    };\n    function addDefs(defs) {\n        for (let def of defs) {\n            const pluginName = def.name;\n            const currentId = currentPluginIds[pluginName];\n            if (currentId === undefined) {\n                currentPluginIds[pluginName] = def.id;\n                addDefs(def.deps);\n                hooks = combineHooks(hooks, def);\n            }\n            else if (currentId !== def.id) {\n                // different ID than the one already added\n                console.warn(`Duplicate plugin '${pluginName}'`);\n            }\n        }\n    }\n    if (pluginDefs) {\n        addDefs(pluginDefs);\n    }\n    addDefs(globalDefs);\n    return hooks;\n}\nfunction buildBuildPluginHooks() {\n    let currentOverrideDefs = [];\n    let currentGlobalDefs = [];\n    let currentHooks;\n    return (overrideDefs, globalDefs) => {\n        if (!currentHooks || !isArraysEqual(overrideDefs, currentOverrideDefs) || !isArraysEqual(globalDefs, currentGlobalDefs)) {\n            currentHooks = buildPluginHooks(overrideDefs, globalDefs);\n        }\n        currentOverrideDefs = overrideDefs;\n        currentGlobalDefs = globalDefs;\n        return currentHooks;\n    };\n}\nfunction combineHooks(hooks0, hooks1) {\n    return {\n        premiumReleaseDate: compareOptionalDates(hooks0.premiumReleaseDate, hooks1.premiumReleaseDate),\n        reducers: hooks0.reducers.concat(hooks1.reducers),\n        isLoadingFuncs: hooks0.isLoadingFuncs.concat(hooks1.isLoadingFuncs),\n        contextInit: hooks0.contextInit.concat(hooks1.contextInit),\n        eventRefiners: Object.assign(Object.assign({}, hooks0.eventRefiners), hooks1.eventRefiners),\n        eventDefMemberAdders: hooks0.eventDefMemberAdders.concat(hooks1.eventDefMemberAdders),\n        eventSourceRefiners: Object.assign(Object.assign({}, hooks0.eventSourceRefiners), hooks1.eventSourceRefiners),\n        isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n        eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n        eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n        dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n        datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n        dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n        views: Object.assign(Object.assign({}, hooks0.views), hooks1.views),\n        viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n        isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n        externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n        viewContainerAppends: hooks0.viewContainerAppends.concat(hooks1.viewContainerAppends),\n        eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n        calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n        componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n        themeClasses: Object.assign(Object.assign({}, hooks0.themeClasses), hooks1.themeClasses),\n        eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n        cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n        recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n        namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n        initialView: hooks0.initialView || hooks1.initialView,\n        elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n        optionChangeHandlers: Object.assign(Object.assign({}, hooks0.optionChangeHandlers), hooks1.optionChangeHandlers),\n        scrollGridImpl: hooks1.scrollGridImpl || hooks0.scrollGridImpl,\n        listenerRefiners: Object.assign(Object.assign({}, hooks0.listenerRefiners), hooks1.listenerRefiners),\n        optionRefiners: Object.assign(Object.assign({}, hooks0.optionRefiners), hooks1.optionRefiners),\n        propSetHandlers: Object.assign(Object.assign({}, hooks0.propSetHandlers), hooks1.propSetHandlers),\n    };\n}\nfunction compareOptionalDates(date0, date1) {\n    if (date0 === undefined) {\n        return date1;\n    }\n    if (date1 === undefined) {\n        return date0;\n    }\n    return new Date(Math.max(date0.valueOf(), date1.valueOf()));\n}\n\nclass StandardTheme extends Theme {\n}\nStandardTheme.prototype.classes = {\n    root: 'fc-theme-standard',\n    tableCellShaded: 'fc-cell-shaded',\n    buttonGroup: 'fc-button-group',\n    button: 'fc-button fc-button-primary',\n    buttonActive: 'fc-button-active',\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n    close: 'fc-icon-x',\n    prev: 'fc-icon-chevron-left',\n    next: 'fc-icon-chevron-right',\n    prevYear: 'fc-icon-chevrons-left',\n    nextYear: 'fc-icon-chevrons-right',\n};\nStandardTheme.prototype.rtlIconClasses = {\n    prev: 'fc-icon-chevron-right',\n    next: 'fc-icon-chevron-left',\n    prevYear: 'fc-icon-chevrons-right',\n    nextYear: 'fc-icon-chevrons-left',\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons'; // TODO: make TS-friendly\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n    let hash = {};\n    let viewType;\n    for (viewType in defaultConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    for (viewType in overrideConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    return hash;\n}\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    if (hash[viewType]) {\n        return hash[viewType];\n    }\n    let viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    if (viewDef) {\n        hash[viewType] = viewDef;\n    }\n    return viewDef;\n}\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    let defaultConfig = defaultConfigs[viewType];\n    let overrideConfig = overrideConfigs[viewType];\n    let queryProp = (name) => ((defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\n        ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null));\n    let theComponent = queryProp('component');\n    let superType = queryProp('superType');\n    let superDef = null;\n    if (superType) {\n        if (superType === viewType) {\n            throw new Error('Can\\'t have a custom view type that references itself');\n        }\n        superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n    }\n    if (!theComponent && superDef) {\n        theComponent = superDef.component;\n    }\n    if (!theComponent) {\n        return null; // don't throw a warning, might be settings for a single-unit view\n    }\n    return {\n        type: viewType,\n        component: theComponent,\n        defaults: Object.assign(Object.assign({}, (superDef ? superDef.defaults : {})), (defaultConfig ? defaultConfig.rawOptions : {})),\n        overrides: Object.assign(Object.assign({}, (superDef ? superDef.overrides : {})), (overrideConfig ? overrideConfig.rawOptions : {})),\n    };\n}\n\nfunction parseViewConfigs(inputs) {\n    return mapHash(inputs, parseViewConfig);\n}\nfunction parseViewConfig(input) {\n    let rawOptions = typeof input === 'function' ?\n        { component: input } :\n        input;\n    let { component } = rawOptions;\n    if (rawOptions.content) {\n        // TODO: remove content/classNames/didMount/etc from options?\n        component = createViewHookComponent(rawOptions);\n    }\n    else if (component && !(component.prototype instanceof BaseComponent)) {\n        // WHY?: people were using `component` property for `content`\n        // TODO: converge on one setting name\n        component = createViewHookComponent(Object.assign(Object.assign({}, rawOptions), { content: component }));\n    }\n    return {\n        superType: rawOptions.type,\n        component: component,\n        rawOptions, // includes type and component too :(\n    };\n}\nfunction createViewHookComponent(options) {\n    return (viewProps) => (createElement(ViewContextType.Consumer, null, (context) => (createElement(ContentContainer, { elTag: \"div\", elClasses: buildViewClassNames(context.viewSpec), renderProps: Object.assign(Object.assign({}, viewProps), { nextDayThreshold: context.options.nextDayThreshold }), generatorName: undefined, customGenerator: options.content, classNameGenerator: options.classNames, didMount: options.didMount, willUnmount: options.willUnmount }))));\n}\n\nfunction buildViewSpecs(defaultInputs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n    let defaultConfigs = parseViewConfigs(defaultInputs);\n    let overrideConfigs = parseViewConfigs(optionOverrides.views);\n    let viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n    return mapHash(viewDefs, (viewDef) => buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults));\n}\nfunction buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n    let durationInput = viewDef.overrides.duration ||\n        viewDef.defaults.duration ||\n        dynamicOptionOverrides.duration ||\n        optionOverrides.duration;\n    let duration = null;\n    let durationUnit = '';\n    let singleUnit = '';\n    let singleUnitOverrides = {};\n    if (durationInput) {\n        duration = createDurationCached(durationInput);\n        if (duration) { // valid?\n            let denom = greatestDurationDenominator(duration);\n            durationUnit = denom.unit;\n            if (denom.value === 1) {\n                singleUnit = durationUnit;\n                singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].rawOptions : {};\n            }\n        }\n    }\n    let queryButtonText = (optionsSubset) => {\n        let buttonTextMap = optionsSubset.buttonText || {};\n        let buttonTextKey = viewDef.defaults.buttonTextKey;\n        if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n            return buttonTextMap[buttonTextKey];\n        }\n        if (buttonTextMap[viewDef.type] != null) {\n            return buttonTextMap[viewDef.type];\n        }\n        if (buttonTextMap[singleUnit] != null) {\n            return buttonTextMap[singleUnit];\n        }\n        return null;\n    };\n    let queryButtonTitle = (optionsSubset) => {\n        let buttonHints = optionsSubset.buttonHints || {};\n        let buttonKey = viewDef.defaults.buttonTextKey; // use same key as text\n        if (buttonKey != null && buttonHints[buttonKey] != null) {\n            return buttonHints[buttonKey];\n        }\n        if (buttonHints[viewDef.type] != null) {\n            return buttonHints[viewDef.type];\n        }\n        if (buttonHints[singleUnit] != null) {\n            return buttonHints[singleUnit];\n        }\n        return null;\n    };\n    return {\n        type: viewDef.type,\n        component: viewDef.component,\n        duration,\n        durationUnit,\n        singleUnit,\n        optionDefaults: viewDef.defaults,\n        optionOverrides: Object.assign(Object.assign({}, singleUnitOverrides), viewDef.overrides),\n        buttonTextOverride: queryButtonText(dynamicOptionOverrides) ||\n            queryButtonText(optionOverrides) || // constructor-specified buttonText lookup hash takes precedence\n            viewDef.overrides.buttonText,\n        buttonTextDefault: queryButtonText(localeDefaults) ||\n            viewDef.defaults.buttonText ||\n            queryButtonText(BASE_OPTION_DEFAULTS) ||\n            viewDef.type,\n        // not DRY\n        buttonTitleOverride: queryButtonTitle(dynamicOptionOverrides) ||\n            queryButtonTitle(optionOverrides) ||\n            viewDef.overrides.buttonHint,\n        buttonTitleDefault: queryButtonTitle(localeDefaults) ||\n            viewDef.defaults.buttonHint ||\n            queryButtonTitle(BASE_OPTION_DEFAULTS),\n        // will eventually fall back to buttonText\n    };\n}\n// hack to get memoization working\nlet durationInputMap = {};\nfunction createDurationCached(durationInput) {\n    let json = JSON.stringify(durationInput);\n    let res = durationInputMap[json];\n    if (res === undefined) {\n        res = createDuration(durationInput);\n        durationInputMap[json] = res;\n    }\n    return res;\n}\n\nfunction reduceViewType(viewType, action) {\n    switch (action.type) {\n        case 'CHANGE_VIEW_TYPE':\n            viewType = action.viewType;\n    }\n    return viewType;\n}\n\nfunction reduceDynamicOptionOverrides(dynamicOptionOverrides, action) {\n    switch (action.type) {\n        case 'SET_OPTION':\n            return Object.assign(Object.assign({}, dynamicOptionOverrides), { [action.optionName]: action.rawOptionValue });\n        default:\n            return dynamicOptionOverrides;\n    }\n}\n\nfunction reduceDateProfile(currentDateProfile, action, currentDate, dateProfileGenerator) {\n    let dp;\n    switch (action.type) {\n        case 'CHANGE_VIEW_TYPE':\n            return dateProfileGenerator.build(action.dateMarker || currentDate);\n        case 'CHANGE_DATE':\n            return dateProfileGenerator.build(action.dateMarker);\n        case 'PREV':\n            dp = dateProfileGenerator.buildPrev(currentDateProfile, currentDate);\n            if (dp.isValid) {\n                return dp;\n            }\n            break;\n        case 'NEXT':\n            dp = dateProfileGenerator.buildNext(currentDateProfile, currentDate);\n            if (dp.isValid) {\n                return dp;\n            }\n            break;\n    }\n    return currentDateProfile;\n}\n\nfunction initEventSources(calendarOptions, dateProfile, context) {\n    let activeRange = dateProfile ? dateProfile.activeRange : null;\n    return addSources({}, parseInitialSources(calendarOptions, context), activeRange, context);\n}\nfunction reduceEventSources(eventSources, action, dateProfile, context) {\n    let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n    switch (action.type) {\n        case 'ADD_EVENT_SOURCES': // already parsed\n            return addSources(eventSources, action.sources, activeRange, context);\n        case 'REMOVE_EVENT_SOURCE':\n            return removeSource(eventSources, action.sourceId);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'CHANGE_DATE':\n        case 'CHANGE_VIEW_TYPE':\n            if (dateProfile) {\n                return fetchDirtySources(eventSources, activeRange, context);\n            }\n            return eventSources;\n        case 'FETCH_EVENT_SOURCES':\n            return fetchSourcesByIds(eventSources, action.sourceIds ? // why no type?\n                arrayToHash(action.sourceIds) :\n                excludeStaticSources(eventSources, context), activeRange, action.isRefetch || false, context);\n        case 'RECEIVE_EVENTS':\n        case 'RECEIVE_EVENT_ERROR':\n            return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n        case 'REMOVE_ALL_EVENT_SOURCES':\n            return {};\n        default:\n            return eventSources;\n    }\n}\nfunction reduceEventSourcesNewTimeZone(eventSources, dateProfile, context) {\n    let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n    return fetchSourcesByIds(eventSources, excludeStaticSources(eventSources, context), activeRange, true, context);\n}\nfunction computeEventSourcesLoading(eventSources) {\n    for (let sourceId in eventSources) {\n        if (eventSources[sourceId].isFetching) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction addSources(eventSourceHash, sources, fetchRange, context) {\n    let hash = {};\n    for (let source of sources) {\n        hash[source.sourceId] = source;\n    }\n    if (fetchRange) {\n        hash = fetchDirtySources(hash, fetchRange, context);\n    }\n    return Object.assign(Object.assign({}, eventSourceHash), hash);\n}\nfunction removeSource(eventSourceHash, sourceId) {\n    return filterHash(eventSourceHash, (eventSource) => eventSource.sourceId !== sourceId);\n}\nfunction fetchDirtySources(sourceHash, fetchRange, context) {\n    return fetchSourcesByIds(sourceHash, filterHash(sourceHash, (eventSource) => isSourceDirty(eventSource, fetchRange, context)), fetchRange, false, context);\n}\nfunction isSourceDirty(eventSource, fetchRange, context) {\n    if (!doesSourceNeedRange(eventSource, context)) {\n        return !eventSource.latestFetchId;\n    }\n    return !context.options.lazyFetching ||\n        !eventSource.fetchRange ||\n        eventSource.isFetching || // always cancel outdated in-progress fetches\n        fetchRange.start < eventSource.fetchRange.start ||\n        fetchRange.end > eventSource.fetchRange.end;\n}\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, isRefetch, context) {\n    let nextSources = {};\n    for (let sourceId in prevSources) {\n        let source = prevSources[sourceId];\n        if (sourceIdHash[sourceId]) {\n            nextSources[sourceId] = fetchSource(source, fetchRange, isRefetch, context);\n        }\n        else {\n            nextSources[sourceId] = source;\n        }\n    }\n    return nextSources;\n}\nfunction fetchSource(eventSource, fetchRange, isRefetch, context) {\n    let { options, calendarApi } = context;\n    let sourceDef = context.pluginHooks.eventSourceDefs[eventSource.sourceDefId];\n    let fetchId = guid();\n    sourceDef.fetch({\n        eventSource,\n        range: fetchRange,\n        isRefetch,\n        context,\n    }, (res) => {\n        let { rawEvents } = res;\n        if (options.eventSourceSuccess) {\n            rawEvents = options.eventSourceSuccess.call(calendarApi, rawEvents, res.response) || rawEvents;\n        }\n        if (eventSource.success) {\n            rawEvents = eventSource.success.call(calendarApi, rawEvents, res.response) || rawEvents;\n        }\n        context.dispatch({\n            type: 'RECEIVE_EVENTS',\n            sourceId: eventSource.sourceId,\n            fetchId,\n            fetchRange,\n            rawEvents,\n        });\n    }, (error) => {\n        let errorHandled = false;\n        if (options.eventSourceFailure) {\n            options.eventSourceFailure.call(calendarApi, error);\n            errorHandled = true;\n        }\n        if (eventSource.failure) {\n            eventSource.failure(error);\n            errorHandled = true;\n        }\n        if (!errorHandled) {\n            console.warn(error.message, error);\n        }\n        context.dispatch({\n            type: 'RECEIVE_EVENT_ERROR',\n            sourceId: eventSource.sourceId,\n            fetchId,\n            fetchRange,\n            error,\n        });\n    });\n    return Object.assign(Object.assign({}, eventSource), { isFetching: true, latestFetchId: fetchId });\n}\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n    let eventSource = sourceHash[sourceId];\n    if (eventSource && // not already removed\n        fetchId === eventSource.latestFetchId) {\n        return Object.assign(Object.assign({}, sourceHash), { [sourceId]: Object.assign(Object.assign({}, eventSource), { isFetching: false, fetchRange }) });\n    }\n    return sourceHash;\n}\nfunction excludeStaticSources(eventSources, context) {\n    return filterHash(eventSources, (eventSource) => doesSourceNeedRange(eventSource, context));\n}\nfunction parseInitialSources(rawOptions, context) {\n    let refiners = buildEventSourceRefiners(context);\n    let rawSources = [].concat(rawOptions.eventSources || []);\n    let sources = []; // parsed\n    if (rawOptions.initialEvents) {\n        rawSources.unshift(rawOptions.initialEvents);\n    }\n    if (rawOptions.events) {\n        rawSources.unshift(rawOptions.events);\n    }\n    for (let rawSource of rawSources) {\n        let source = parseEventSource(rawSource, context, refiners);\n        if (source) {\n            sources.push(source);\n        }\n    }\n    return sources;\n}\nfunction doesSourceNeedRange(eventSource, context) {\n    let defs = context.pluginHooks.eventSourceDefs;\n    return !defs[eventSource.sourceDefId].ignoreRange;\n}\n\nfunction reduceDateSelection(currentSelection, action) {\n    switch (action.type) {\n        case 'UNSELECT_DATES':\n            return null;\n        case 'SELECT_DATES':\n            return action.selection;\n        default:\n            return currentSelection;\n    }\n}\n\nfunction reduceSelectedEvent(currentInstanceId, action) {\n    switch (action.type) {\n        case 'UNSELECT_EVENT':\n            return '';\n        case 'SELECT_EVENT':\n            return action.eventInstanceId;\n        default:\n            return currentInstanceId;\n    }\n}\n\nfunction reduceEventDrag(currentDrag, action) {\n    let newDrag;\n    switch (action.type) {\n        case 'UNSET_EVENT_DRAG':\n            return null;\n        case 'SET_EVENT_DRAG':\n            newDrag = action.state;\n            return {\n                affectedEvents: newDrag.affectedEvents,\n                mutatedEvents: newDrag.mutatedEvents,\n                isEvent: newDrag.isEvent,\n            };\n        default:\n            return currentDrag;\n    }\n}\n\nfunction reduceEventResize(currentResize, action) {\n    let newResize;\n    switch (action.type) {\n        case 'UNSET_EVENT_RESIZE':\n            return null;\n        case 'SET_EVENT_RESIZE':\n            newResize = action.state;\n            return {\n                affectedEvents: newResize.affectedEvents,\n                mutatedEvents: newResize.mutatedEvents,\n                isEvent: newResize.isEvent,\n            };\n        default:\n            return currentResize;\n    }\n}\n\nfunction parseToolbars(calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n    let header = calendarOptions.headerToolbar ? parseToolbar(calendarOptions.headerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n    let footer = calendarOptions.footerToolbar ? parseToolbar(calendarOptions.footerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n    return { header, footer };\n}\nfunction parseToolbar(sectionStrHash, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n    let sectionWidgets = {};\n    let viewsWithButtons = [];\n    let hasTitle = false;\n    for (let sectionName in sectionStrHash) {\n        let sectionStr = sectionStrHash[sectionName];\n        let sectionRes = parseSection(sectionStr, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi);\n        sectionWidgets[sectionName] = sectionRes.widgets;\n        viewsWithButtons.push(...sectionRes.viewsWithButtons);\n        hasTitle = hasTitle || sectionRes.hasTitle;\n    }\n    return { sectionWidgets, viewsWithButtons, hasTitle };\n}\n/*\nBAD: querying icons and text here. should be done at render time\n*/\nfunction parseSection(sectionStr, calendarOptions, // defaults+overrides, then refined\ncalendarOptionOverrides, // overrides only!, unrefined :(\ntheme, viewSpecs, calendarApi) {\n    let isRtl = calendarOptions.direction === 'rtl';\n    let calendarCustomButtons = calendarOptions.customButtons || {};\n    let calendarButtonTextOverrides = calendarOptionOverrides.buttonText || {};\n    let calendarButtonText = calendarOptions.buttonText || {};\n    let calendarButtonHintOverrides = calendarOptionOverrides.buttonHints || {};\n    let calendarButtonHints = calendarOptions.buttonHints || {};\n    let sectionSubstrs = sectionStr ? sectionStr.split(' ') : [];\n    let viewsWithButtons = [];\n    let hasTitle = false;\n    let widgets = sectionSubstrs.map((buttonGroupStr) => (buttonGroupStr.split(',').map((buttonName) => {\n        if (buttonName === 'title') {\n            hasTitle = true;\n            return { buttonName };\n        }\n        let customButtonProps;\n        let viewSpec;\n        let buttonClick;\n        let buttonIcon; // only one of these will be set\n        let buttonText; // \"\n        let buttonHint;\n        // ^ for the title=\"\" attribute, for accessibility\n        if ((customButtonProps = calendarCustomButtons[buttonName])) {\n            buttonClick = (ev) => {\n                if (customButtonProps.click) {\n                    customButtonProps.click.call(ev.target, ev, ev.target); // TODO: use Calendar this context?\n                }\n            };\n            (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\n                (buttonText = customButtonProps.text);\n            buttonHint = customButtonProps.hint || customButtonProps.text;\n        }\n        else if ((viewSpec = viewSpecs[buttonName])) {\n            viewsWithButtons.push(buttonName);\n            buttonClick = () => {\n                calendarApi.changeView(buttonName);\n            };\n            (buttonText = viewSpec.buttonTextOverride) ||\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\n                (buttonText = viewSpec.buttonTextDefault);\n            let textFallback = viewSpec.buttonTextOverride ||\n                viewSpec.buttonTextDefault;\n            buttonHint = formatWithOrdinals(viewSpec.buttonTitleOverride ||\n                viewSpec.buttonTitleDefault ||\n                calendarOptions.viewHint, [textFallback, buttonName], // view-name = buttonName\n            textFallback);\n        }\n        else if (calendarApi[buttonName]) { // a calendarApi method\n            buttonClick = () => {\n                calendarApi[buttonName]();\n            };\n            (buttonText = calendarButtonTextOverrides[buttonName]) ||\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\n                (buttonText = calendarButtonText[buttonName]); // everything else is considered default\n            if (buttonName === 'prevYear' || buttonName === 'nextYear') {\n                let prevOrNext = buttonName === 'prevYear' ? 'prev' : 'next';\n                buttonHint = formatWithOrdinals(calendarButtonHintOverrides[prevOrNext] ||\n                    calendarButtonHints[prevOrNext], [\n                    calendarButtonText.year || 'year',\n                    'year',\n                ], calendarButtonText[buttonName]);\n            }\n            else {\n                buttonHint = (navUnit) => formatWithOrdinals(calendarButtonHintOverrides[buttonName] ||\n                    calendarButtonHints[buttonName], [\n                    calendarButtonText[navUnit] || navUnit,\n                    navUnit,\n                ], calendarButtonText[buttonName]);\n            }\n        }\n        return { buttonName, buttonClick, buttonIcon, buttonText, buttonHint };\n    })));\n    return { widgets, viewsWithButtons, hasTitle };\n}\n\n// always represents the current view. otherwise, it'd need to change value every time date changes\nclass ViewImpl {\n    constructor(type, getCurrentData, dateEnv) {\n        this.type = type;\n        this.getCurrentData = getCurrentData;\n        this.dateEnv = dateEnv;\n    }\n    get calendar() {\n        return this.getCurrentData().calendarApi;\n    }\n    get title() {\n        return this.getCurrentData().viewTitle;\n    }\n    get activeStart() {\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start);\n    }\n    get activeEnd() {\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end);\n    }\n    get currentStart() {\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start);\n    }\n    get currentEnd() {\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end);\n    }\n    getOption(name) {\n        return this.getCurrentData().options[name]; // are the view-specific options\n    }\n}\n\nlet eventSourceDef$2 = {\n    ignoreRange: true,\n    parseMeta(refined) {\n        if (Array.isArray(refined.events)) {\n            return refined.events;\n        }\n        return null;\n    },\n    fetch(arg, successCallback) {\n        successCallback({\n            rawEvents: arg.eventSource.meta,\n        });\n    },\n};\nconst arrayEventSourcePlugin = createPlugin({\n    name: 'array-event-source',\n    eventSourceDefs: [eventSourceDef$2],\n});\n\nlet eventSourceDef$1 = {\n    parseMeta(refined) {\n        if (typeof refined.events === 'function') {\n            return refined.events;\n        }\n        return null;\n    },\n    fetch(arg, successCallback, errorCallback) {\n        const { dateEnv } = arg.context;\n        const func = arg.eventSource.meta;\n        unpromisify(func.bind(null, buildRangeApiWithTimeZone(arg.range, dateEnv)), (rawEvents) => successCallback({ rawEvents }), errorCallback);\n    },\n};\nconst funcEventSourcePlugin = createPlugin({\n    name: 'func-event-source',\n    eventSourceDefs: [eventSourceDef$1],\n});\n\nconst JSON_FEED_EVENT_SOURCE_REFINERS = {\n    method: String,\n    extraParams: identity,\n    startParam: String,\n    endParam: String,\n    timeZoneParam: String,\n};\n\nlet eventSourceDef = {\n    parseMeta(refined) {\n        if (refined.url && (refined.format === 'json' || !refined.format)) {\n            return {\n                url: refined.url,\n                format: 'json',\n                method: (refined.method || 'GET').toUpperCase(),\n                extraParams: refined.extraParams,\n                startParam: refined.startParam,\n                endParam: refined.endParam,\n                timeZoneParam: refined.timeZoneParam,\n            };\n        }\n        return null;\n    },\n    fetch(arg, successCallback, errorCallback) {\n        const { meta } = arg.eventSource;\n        const requestParams = buildRequestParams(meta, arg.range, arg.context);\n        requestJson(meta.method, meta.url, requestParams).then(([rawEvents, response]) => {\n            successCallback({ rawEvents, response });\n        }, errorCallback);\n    },\n};\nconst jsonFeedEventSourcePlugin = createPlugin({\n    name: 'json-event-source',\n    eventSourceRefiners: JSON_FEED_EVENT_SOURCE_REFINERS,\n    eventSourceDefs: [eventSourceDef],\n});\nfunction buildRequestParams(meta, range, context) {\n    let { dateEnv, options } = context;\n    let startParam;\n    let endParam;\n    let timeZoneParam;\n    let customRequestParams;\n    let params = {};\n    startParam = meta.startParam;\n    if (startParam == null) {\n        startParam = options.startParam;\n    }\n    endParam = meta.endParam;\n    if (endParam == null) {\n        endParam = options.endParam;\n    }\n    timeZoneParam = meta.timeZoneParam;\n    if (timeZoneParam == null) {\n        timeZoneParam = options.timeZoneParam;\n    }\n    // retrieve any outbound GET/POST data from the options\n    if (typeof meta.extraParams === 'function') {\n        // supplied as a function that returns a key/value object\n        customRequestParams = meta.extraParams();\n    }\n    else {\n        // probably supplied as a straight key/value object\n        customRequestParams = meta.extraParams || {};\n    }\n    Object.assign(params, customRequestParams);\n    params[startParam] = dateEnv.formatIso(range.start);\n    params[endParam] = dateEnv.formatIso(range.end);\n    if (dateEnv.timeZone !== 'local') {\n        params[timeZoneParam] = dateEnv.timeZone;\n    }\n    return params;\n}\n\nconst SIMPLE_RECURRING_REFINERS = {\n    daysOfWeek: identity,\n    startTime: createDuration,\n    endTime: createDuration,\n    duration: createDuration,\n    startRecur: identity,\n    endRecur: identity,\n};\n\nlet recurring = {\n    parse(refined, dateEnv) {\n        if (refined.daysOfWeek || refined.startTime || refined.endTime || refined.startRecur || refined.endRecur) {\n            let recurringData = {\n                daysOfWeek: refined.daysOfWeek || null,\n                startTime: refined.startTime || null,\n                endTime: refined.endTime || null,\n                startRecur: refined.startRecur ? dateEnv.createMarker(refined.startRecur) : null,\n                endRecur: refined.endRecur ? dateEnv.createMarker(refined.endRecur) : null,\n            };\n            let duration;\n            if (refined.duration) {\n                duration = refined.duration;\n            }\n            if (!duration && refined.startTime && refined.endTime) {\n                duration = subtractDurations(refined.endTime, refined.startTime);\n            }\n            return {\n                allDayGuess: Boolean(!refined.startTime && !refined.endTime),\n                duration,\n                typeData: recurringData, // doesn't need endTime anymore but oh well\n            };\n        }\n        return null;\n    },\n    expand(typeData, framingRange, dateEnv) {\n        let clippedFramingRange = intersectRanges(framingRange, { start: typeData.startRecur, end: typeData.endRecur });\n        if (clippedFramingRange) {\n            return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n        }\n        return [];\n    },\n};\nconst simpleRecurringEventsPlugin = createPlugin({\n    name: 'simple-recurring-event',\n    recurringTypes: [recurring],\n    eventRefiners: SIMPLE_RECURRING_REFINERS,\n});\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n    let dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n    let dayMarker = startOfDay(framingRange.start);\n    let endMarker = framingRange.end;\n    let instanceStarts = [];\n    while (dayMarker < endMarker) {\n        let instanceStart;\n        // if everyday, or this particular day-of-week\n        if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n            if (startTime) {\n                instanceStart = dateEnv.add(dayMarker, startTime);\n            }\n            else {\n                instanceStart = dayMarker;\n            }\n            instanceStarts.push(instanceStart);\n        }\n        dayMarker = addDays(dayMarker, 1);\n    }\n    return instanceStarts;\n}\n\nconst changeHandlerPlugin = createPlugin({\n    name: 'change-handler',\n    optionChangeHandlers: {\n        events(events, context) {\n            handleEventSources([events], context);\n        },\n        eventSources: handleEventSources,\n    },\n});\n/*\nBUG: if `event` was supplied, all previously-given `eventSources` will be wiped out\n*/\nfunction handleEventSources(inputs, context) {\n    let unfoundSources = hashValuesToArray(context.getCurrentData().eventSources);\n    if (unfoundSources.length === 1 &&\n        inputs.length === 1 &&\n        Array.isArray(unfoundSources[0]._raw) &&\n        Array.isArray(inputs[0])) {\n        context.dispatch({\n            type: 'RESET_RAW_EVENTS',\n            sourceId: unfoundSources[0].sourceId,\n            rawEvents: inputs[0],\n        });\n        return;\n    }\n    let newInputs = [];\n    for (let input of inputs) {\n        let inputFound = false;\n        for (let i = 0; i < unfoundSources.length; i += 1) {\n            if (unfoundSources[i]._raw === input) {\n                unfoundSources.splice(i, 1); // delete\n                inputFound = true;\n                break;\n            }\n        }\n        if (!inputFound) {\n            newInputs.push(input);\n        }\n    }\n    for (let unfoundSource of unfoundSources) {\n        context.dispatch({\n            type: 'REMOVE_EVENT_SOURCE',\n            sourceId: unfoundSource.sourceId,\n        });\n    }\n    for (let newInput of newInputs) {\n        context.calendarApi.addEventSource(newInput);\n    }\n}\n\nfunction handleDateProfile(dateProfile, context) {\n    context.emitter.trigger('datesSet', Object.assign(Object.assign({}, buildRangeApiWithTimeZone(dateProfile.activeRange, context.dateEnv)), { view: context.viewApi }));\n}\n\nfunction handleEventStore(eventStore, context) {\n    let { emitter } = context;\n    if (emitter.hasHandlers('eventsSet')) {\n        emitter.trigger('eventsSet', buildEventApis(eventStore, context));\n    }\n}\n\n/*\nthis array is exposed on the root namespace so that UMD plugins can add to it.\nsee the rollup-bundles script.\n*/\nconst globalPlugins = [\n    arrayEventSourcePlugin,\n    funcEventSourcePlugin,\n    jsonFeedEventSourcePlugin,\n    simpleRecurringEventsPlugin,\n    changeHandlerPlugin,\n    createPlugin({\n        name: 'misc',\n        isLoadingFuncs: [\n            (state) => computeEventSourcesLoading(state.eventSources),\n        ],\n        propSetHandlers: {\n            dateProfile: handleDateProfile,\n            eventStore: handleEventStore,\n        },\n    }),\n];\n\nclass TaskRunner {\n    constructor(runTaskOption, drainedOption) {\n        this.runTaskOption = runTaskOption;\n        this.drainedOption = drainedOption;\n        this.queue = [];\n        this.delayedRunner = new DelayedRunner(this.drain.bind(this));\n    }\n    request(task, delay) {\n        this.queue.push(task);\n        this.delayedRunner.request(delay);\n    }\n    pause(scope) {\n        this.delayedRunner.pause(scope);\n    }\n    resume(scope, force) {\n        this.delayedRunner.resume(scope, force);\n    }\n    drain() {\n        let { queue } = this;\n        while (queue.length) {\n            let completedTasks = [];\n            let task;\n            while ((task = queue.shift())) {\n                this.runTask(task);\n                completedTasks.push(task);\n            }\n            this.drained(completedTasks);\n        } // keep going, in case new tasks were added in the drained handler\n    }\n    runTask(task) {\n        if (this.runTaskOption) {\n            this.runTaskOption(task);\n        }\n    }\n    drained(completedTasks) {\n        if (this.drainedOption) {\n            this.drainedOption(completedTasks);\n        }\n    }\n}\n\n// Computes what the title at the top of the calendarApi should be for this view\nfunction buildTitle(dateProfile, viewOptions, dateEnv) {\n    let range;\n    // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n    if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n        range = dateProfile.currentRange;\n    }\n    else { // for day units or smaller, use the actual day range\n        range = dateProfile.activeRange;\n    }\n    return dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || buildTitleFormat(dateProfile)), {\n        isEndExclusive: dateProfile.isRangeAllDay,\n        defaultSeparator: viewOptions.titleRangeSeparator,\n    });\n}\n// Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\nfunction buildTitleFormat(dateProfile) {\n    let { currentRangeUnit } = dateProfile;\n    if (currentRangeUnit === 'year') {\n        return { year: 'numeric' };\n    }\n    if (currentRangeUnit === 'month') {\n        return { year: 'numeric', month: 'long' }; // like \"September 2014\"\n    }\n    let days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n    if (days !== null && days > 1) {\n        // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n        return { year: 'numeric', month: 'short', day: 'numeric' };\n    }\n    // one day. longer, like \"September 9 2014\"\n    return { year: 'numeric', month: 'long', day: 'numeric' };\n}\n\n// in future refactor, do the redux-style function(state=initial) for initial-state\n// also, whatever is happening in constructor, have it happen in action queue too\nclass CalendarDataManager {\n    constructor(props) {\n        this.computeCurrentViewData = memoize(this._computeCurrentViewData);\n        this.organizeRawLocales = memoize(organizeRawLocales);\n        this.buildLocale = memoize(buildLocale);\n        this.buildPluginHooks = buildBuildPluginHooks();\n        this.buildDateEnv = memoize(buildDateEnv$1);\n        this.buildTheme = memoize(buildTheme);\n        this.parseToolbars = memoize(parseToolbars);\n        this.buildViewSpecs = memoize(buildViewSpecs);\n        this.buildDateProfileGenerator = memoizeObjArg(buildDateProfileGenerator);\n        this.buildViewApi = memoize(buildViewApi);\n        this.buildViewUiProps = memoizeObjArg(buildViewUiProps);\n        this.buildEventUiBySource = memoize(buildEventUiBySource, isPropsEqual);\n        this.buildEventUiBases = memoize(buildEventUiBases);\n        this.parseContextBusinessHours = memoizeObjArg(parseContextBusinessHours);\n        this.buildTitle = memoize(buildTitle);\n        this.emitter = new Emitter();\n        this.actionRunner = new TaskRunner(this._handleAction.bind(this), this.updateData.bind(this));\n        this.currentCalendarOptionsInput = {};\n        this.currentCalendarOptionsRefined = {};\n        this.currentViewOptionsInput = {};\n        this.currentViewOptionsRefined = {};\n        this.currentCalendarOptionsRefiners = {};\n        this.optionsForRefining = [];\n        this.optionsForHandling = [];\n        this.getCurrentData = () => this.data;\n        this.dispatch = (action) => {\n            this.actionRunner.request(action); // protects against recursive calls to _handleAction\n        };\n        this.props = props;\n        this.actionRunner.pause();\n        let dynamicOptionOverrides = {};\n        let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n        let currentViewType = optionsData.calendarOptions.initialView || optionsData.pluginHooks.initialView;\n        let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\n        // wire things up\n        // TODO: not DRY\n        props.calendarApi.currentDataManager = this;\n        this.emitter.setThisContext(props.calendarApi);\n        this.emitter.setOptions(currentViewData.options);\n        let currentDate = getInitialDate(optionsData.calendarOptions, optionsData.dateEnv);\n        let dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n        if (!rangeContainsMarker(dateProfile.activeRange, currentDate)) {\n            currentDate = dateProfile.currentRange.start;\n        }\n        let calendarContext = {\n            dateEnv: optionsData.dateEnv,\n            options: optionsData.calendarOptions,\n            pluginHooks: optionsData.pluginHooks,\n            calendarApi: props.calendarApi,\n            dispatch: this.dispatch,\n            emitter: this.emitter,\n            getCurrentData: this.getCurrentData,\n        };\n        // needs to be after setThisContext\n        for (let callback of optionsData.pluginHooks.contextInit) {\n            callback(calendarContext);\n        }\n        // NOT DRY\n        let eventSources = initEventSources(optionsData.calendarOptions, dateProfile, calendarContext);\n        let initialState = {\n            dynamicOptionOverrides,\n            currentViewType,\n            currentDate,\n            dateProfile,\n            businessHours: this.parseContextBusinessHours(calendarContext),\n            eventSources,\n            eventUiBases: {},\n            eventStore: createEmptyEventStore(),\n            renderableEventStore: createEmptyEventStore(),\n            dateSelection: null,\n            eventSelection: '',\n            eventDrag: null,\n            eventResize: null,\n            selectionConfig: this.buildViewUiProps(calendarContext).selectionConfig,\n        };\n        let contextAndState = Object.assign(Object.assign({}, calendarContext), initialState);\n        for (let reducer of optionsData.pluginHooks.reducers) {\n            Object.assign(initialState, reducer(null, null, contextAndState));\n        }\n        if (computeIsLoading(initialState, calendarContext)) {\n            this.emitter.trigger('loading', true); // NOT DRY\n        }\n        this.state = initialState;\n        this.updateData();\n        this.actionRunner.resume();\n    }\n    resetOptions(optionOverrides, changedOptionNames) {\n        let { props } = this;\n        if (changedOptionNames === undefined) {\n            props.optionOverrides = optionOverrides;\n        }\n        else {\n            props.optionOverrides = Object.assign(Object.assign({}, (props.optionOverrides || {})), optionOverrides);\n            this.optionsForRefining.push(...changedOptionNames);\n        }\n        if (changedOptionNames === undefined || changedOptionNames.length) {\n            this.actionRunner.request({\n                type: 'NOTHING',\n            });\n        }\n    }\n    _handleAction(action) {\n        let { props, state, emitter } = this;\n        let dynamicOptionOverrides = reduceDynamicOptionOverrides(state.dynamicOptionOverrides, action);\n        let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n        let currentViewType = reduceViewType(state.currentViewType, action);\n        let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\n        // wire things up\n        // TODO: not DRY\n        props.calendarApi.currentDataManager = this;\n        emitter.setThisContext(props.calendarApi);\n        emitter.setOptions(currentViewData.options);\n        let calendarContext = {\n            dateEnv: optionsData.dateEnv,\n            options: optionsData.calendarOptions,\n            pluginHooks: optionsData.pluginHooks,\n            calendarApi: props.calendarApi,\n            dispatch: this.dispatch,\n            emitter,\n            getCurrentData: this.getCurrentData,\n        };\n        let { currentDate, dateProfile } = state;\n        if (this.data && this.data.dateProfileGenerator !== currentViewData.dateProfileGenerator) { // hack\n            dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n        }\n        currentDate = reduceCurrentDate(currentDate, action);\n        dateProfile = reduceDateProfile(dateProfile, action, currentDate, currentViewData.dateProfileGenerator);\n        if (action.type === 'PREV' || // TODO: move this logic into DateProfileGenerator\n            action.type === 'NEXT' || // \"\n            !rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n            currentDate = dateProfile.currentRange.start;\n        }\n        let eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendarContext);\n        let eventStore = reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendarContext);\n        let isEventsLoading = computeEventSourcesLoading(eventSources); // BAD. also called in this func in computeIsLoading\n        let renderableEventStore = (isEventsLoading && !currentViewData.options.progressiveEventRendering) ?\n            (state.renderableEventStore || eventStore) : // try from previous state\n            eventStore;\n        let { eventUiSingleBase, selectionConfig } = this.buildViewUiProps(calendarContext); // will memoize obj\n        let eventUiBySource = this.buildEventUiBySource(eventSources);\n        let eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n        let newState = {\n            dynamicOptionOverrides,\n            currentViewType,\n            currentDate,\n            dateProfile,\n            eventSources,\n            eventStore,\n            renderableEventStore,\n            selectionConfig,\n            eventUiBases,\n            businessHours: this.parseContextBusinessHours(calendarContext),\n            dateSelection: reduceDateSelection(state.dateSelection, action),\n            eventSelection: reduceSelectedEvent(state.eventSelection, action),\n            eventDrag: reduceEventDrag(state.eventDrag, action),\n            eventResize: reduceEventResize(state.eventResize, action),\n        };\n        let contextAndState = Object.assign(Object.assign({}, calendarContext), newState);\n        for (let reducer of optionsData.pluginHooks.reducers) {\n            Object.assign(newState, reducer(state, action, contextAndState)); // give the OLD state, for old value\n        }\n        let wasLoading = computeIsLoading(state, calendarContext);\n        let isLoading = computeIsLoading(newState, calendarContext);\n        // TODO: use propSetHandlers in plugin system\n        if (!wasLoading && isLoading) {\n            emitter.trigger('loading', true);\n        }\n        else if (wasLoading && !isLoading) {\n            emitter.trigger('loading', false);\n        }\n        this.state = newState;\n        if (props.onAction) {\n            props.onAction(action);\n        }\n    }\n    updateData() {\n        let { props, state } = this;\n        let oldData = this.data;\n        let optionsData = this.computeOptionsData(props.optionOverrides, state.dynamicOptionOverrides, props.calendarApi);\n        let currentViewData = this.computeCurrentViewData(state.currentViewType, optionsData, props.optionOverrides, state.dynamicOptionOverrides);\n        let data = this.data = Object.assign(Object.assign(Object.assign({ viewTitle: this.buildTitle(state.dateProfile, currentViewData.options, optionsData.dateEnv), calendarApi: props.calendarApi, dispatch: this.dispatch, emitter: this.emitter, getCurrentData: this.getCurrentData }, optionsData), currentViewData), state);\n        let changeHandlers = optionsData.pluginHooks.optionChangeHandlers;\n        let oldCalendarOptions = oldData && oldData.calendarOptions;\n        let newCalendarOptions = optionsData.calendarOptions;\n        if (oldCalendarOptions && oldCalendarOptions !== newCalendarOptions) {\n            if (oldCalendarOptions.timeZone !== newCalendarOptions.timeZone) {\n                // hack\n                state.eventSources = data.eventSources = reduceEventSourcesNewTimeZone(data.eventSources, state.dateProfile, data);\n                state.eventStore = data.eventStore = rezoneEventStoreDates(data.eventStore, oldData.dateEnv, data.dateEnv);\n                state.renderableEventStore = data.renderableEventStore = rezoneEventStoreDates(data.renderableEventStore, oldData.dateEnv, data.dateEnv);\n            }\n            for (let optionName in changeHandlers) {\n                if (this.optionsForHandling.indexOf(optionName) !== -1 ||\n                    oldCalendarOptions[optionName] !== newCalendarOptions[optionName]) {\n                    changeHandlers[optionName](newCalendarOptions[optionName], data);\n                }\n            }\n        }\n        this.optionsForHandling = [];\n        if (props.onData) {\n            props.onData(data);\n        }\n    }\n    computeOptionsData(optionOverrides, dynamicOptionOverrides, calendarApi) {\n        // TODO: blacklist options that are handled by optionChangeHandlers\n        if (!this.optionsForRefining.length &&\n            optionOverrides === this.stableOptionOverrides &&\n            dynamicOptionOverrides === this.stableDynamicOptionOverrides) {\n            return this.stableCalendarOptionsData;\n        }\n        let { refinedOptions, pluginHooks, localeDefaults, availableLocaleData, extra, } = this.processRawCalendarOptions(optionOverrides, dynamicOptionOverrides);\n        warnUnknownOptions(extra);\n        let dateEnv = this.buildDateEnv(refinedOptions.timeZone, refinedOptions.locale, refinedOptions.weekNumberCalculation, refinedOptions.firstDay, refinedOptions.weekText, pluginHooks, availableLocaleData, refinedOptions.defaultRangeSeparator);\n        let viewSpecs = this.buildViewSpecs(pluginHooks.views, this.stableOptionOverrides, this.stableDynamicOptionOverrides, localeDefaults);\n        let theme = this.buildTheme(refinedOptions, pluginHooks);\n        let toolbarConfig = this.parseToolbars(refinedOptions, this.stableOptionOverrides, theme, viewSpecs, calendarApi);\n        return this.stableCalendarOptionsData = {\n            calendarOptions: refinedOptions,\n            pluginHooks,\n            dateEnv,\n            viewSpecs,\n            theme,\n            toolbarConfig,\n            localeDefaults,\n            availableRawLocales: availableLocaleData.map,\n        };\n    }\n    // always called from behind a memoizer\n    processRawCalendarOptions(optionOverrides, dynamicOptionOverrides) {\n        let { locales, locale } = mergeRawOptions([\n            BASE_OPTION_DEFAULTS,\n            optionOverrides,\n            dynamicOptionOverrides,\n        ]);\n        let availableLocaleData = this.organizeRawLocales(locales);\n        let availableRawLocales = availableLocaleData.map;\n        let localeDefaults = this.buildLocale(locale || availableLocaleData.defaultCode, availableRawLocales).options;\n        let pluginHooks = this.buildPluginHooks(optionOverrides.plugins || [], globalPlugins);\n        let refiners = this.currentCalendarOptionsRefiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n        let extra = {};\n        let raw = mergeRawOptions([\n            BASE_OPTION_DEFAULTS,\n            localeDefaults,\n            optionOverrides,\n            dynamicOptionOverrides,\n        ]);\n        let refined = {};\n        let currentRaw = this.currentCalendarOptionsInput;\n        let currentRefined = this.currentCalendarOptionsRefined;\n        let anyChanges = false;\n        for (let optionName in raw) {\n            if (this.optionsForRefining.indexOf(optionName) === -1 && (raw[optionName] === currentRaw[optionName] || (COMPLEX_OPTION_COMPARATORS[optionName] &&\n                (optionName in currentRaw) &&\n                COMPLEX_OPTION_COMPARATORS[optionName](currentRaw[optionName], raw[optionName])))) {\n                refined[optionName] = currentRefined[optionName];\n            }\n            else if (refiners[optionName]) {\n                refined[optionName] = refiners[optionName](raw[optionName]);\n                anyChanges = true;\n            }\n            else {\n                extra[optionName] = currentRaw[optionName];\n            }\n        }\n        if (anyChanges) {\n            this.currentCalendarOptionsInput = raw;\n            this.currentCalendarOptionsRefined = refined;\n            this.stableOptionOverrides = optionOverrides;\n            this.stableDynamicOptionOverrides = dynamicOptionOverrides;\n        }\n        this.optionsForHandling.push(...this.optionsForRefining);\n        this.optionsForRefining = [];\n        return {\n            rawOptions: this.currentCalendarOptionsInput,\n            refinedOptions: this.currentCalendarOptionsRefined,\n            pluginHooks,\n            availableLocaleData,\n            localeDefaults,\n            extra,\n        };\n    }\n    _computeCurrentViewData(viewType, optionsData, optionOverrides, dynamicOptionOverrides) {\n        let viewSpec = optionsData.viewSpecs[viewType];\n        if (!viewSpec) {\n            throw new Error(`viewType \"${viewType}\" is not available. Please make sure you've loaded all neccessary plugins`);\n        }\n        let { refinedOptions, extra } = this.processRawViewOptions(viewSpec, optionsData.pluginHooks, optionsData.localeDefaults, optionOverrides, dynamicOptionOverrides);\n        warnUnknownOptions(extra);\n        let dateProfileGenerator = this.buildDateProfileGenerator({\n            dateProfileGeneratorClass: viewSpec.optionDefaults.dateProfileGeneratorClass,\n            duration: viewSpec.duration,\n            durationUnit: viewSpec.durationUnit,\n            usesMinMaxTime: viewSpec.optionDefaults.usesMinMaxTime,\n            dateEnv: optionsData.dateEnv,\n            calendarApi: this.props.calendarApi,\n            slotMinTime: refinedOptions.slotMinTime,\n            slotMaxTime: refinedOptions.slotMaxTime,\n            showNonCurrentDates: refinedOptions.showNonCurrentDates,\n            dayCount: refinedOptions.dayCount,\n            dateAlignment: refinedOptions.dateAlignment,\n            dateIncrement: refinedOptions.dateIncrement,\n            hiddenDays: refinedOptions.hiddenDays,\n            weekends: refinedOptions.weekends,\n            nowInput: refinedOptions.now,\n            validRangeInput: refinedOptions.validRange,\n            visibleRangeInput: refinedOptions.visibleRange,\n            fixedWeekCount: refinedOptions.fixedWeekCount,\n        });\n        let viewApi = this.buildViewApi(viewType, this.getCurrentData, optionsData.dateEnv);\n        return { viewSpec, options: refinedOptions, dateProfileGenerator, viewApi };\n    }\n    processRawViewOptions(viewSpec, pluginHooks, localeDefaults, optionOverrides, dynamicOptionOverrides) {\n        let raw = mergeRawOptions([\n            BASE_OPTION_DEFAULTS,\n            viewSpec.optionDefaults,\n            localeDefaults,\n            optionOverrides,\n            viewSpec.optionOverrides,\n            dynamicOptionOverrides,\n        ]);\n        let refiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), VIEW_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n        let refined = {};\n        let currentRaw = this.currentViewOptionsInput;\n        let currentRefined = this.currentViewOptionsRefined;\n        let anyChanges = false;\n        let extra = {};\n        for (let optionName in raw) {\n            if (raw[optionName] === currentRaw[optionName] ||\n                (COMPLEX_OPTION_COMPARATORS[optionName] &&\n                    COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], currentRaw[optionName]))) {\n                refined[optionName] = currentRefined[optionName];\n            }\n            else {\n                if (raw[optionName] === this.currentCalendarOptionsInput[optionName] ||\n                    (COMPLEX_OPTION_COMPARATORS[optionName] &&\n                        COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], this.currentCalendarOptionsInput[optionName]))) {\n                    if (optionName in this.currentCalendarOptionsRefined) { // might be an \"extra\" prop\n                        refined[optionName] = this.currentCalendarOptionsRefined[optionName];\n                    }\n                }\n                else if (refiners[optionName]) {\n                    refined[optionName] = refiners[optionName](raw[optionName]);\n                }\n                else {\n                    extra[optionName] = raw[optionName];\n                }\n                anyChanges = true;\n            }\n        }\n        if (anyChanges) {\n            this.currentViewOptionsInput = raw;\n            this.currentViewOptionsRefined = refined;\n        }\n        return {\n            rawOptions: this.currentViewOptionsInput,\n            refinedOptions: this.currentViewOptionsRefined,\n            extra,\n        };\n    }\n}\nfunction buildDateEnv$1(timeZone, explicitLocale, weekNumberCalculation, firstDay, weekText, pluginHooks, availableLocaleData, defaultSeparator) {\n    let locale = buildLocale(explicitLocale || availableLocaleData.defaultCode, availableLocaleData.map);\n    return new DateEnv({\n        calendarSystem: 'gregory',\n        timeZone,\n        namedTimeZoneImpl: pluginHooks.namedTimeZonedImpl,\n        locale,\n        weekNumberCalculation,\n        firstDay,\n        weekText,\n        cmdFormatter: pluginHooks.cmdFormatter,\n        defaultSeparator,\n    });\n}\nfunction buildTheme(options, pluginHooks) {\n    let ThemeClass = pluginHooks.themeClasses[options.themeSystem] || StandardTheme;\n    return new ThemeClass(options);\n}\nfunction buildDateProfileGenerator(props) {\n    let DateProfileGeneratorClass = props.dateProfileGeneratorClass || DateProfileGenerator;\n    return new DateProfileGeneratorClass(props);\n}\nfunction buildViewApi(type, getCurrentData, dateEnv) {\n    return new ViewImpl(type, getCurrentData, dateEnv);\n}\nfunction buildEventUiBySource(eventSources) {\n    return mapHash(eventSources, (eventSource) => eventSource.ui);\n}\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n    let eventUiBases = { '': eventUiSingleBase };\n    for (let defId in eventDefs) {\n        let def = eventDefs[defId];\n        if (def.sourceId && eventUiBySource[def.sourceId]) {\n            eventUiBases[defId] = eventUiBySource[def.sourceId];\n        }\n    }\n    return eventUiBases;\n}\nfunction buildViewUiProps(calendarContext) {\n    let { options } = calendarContext;\n    return {\n        eventUiSingleBase: createEventUi({\n            display: options.eventDisplay,\n            editable: options.editable,\n            startEditable: options.eventStartEditable,\n            durationEditable: options.eventDurationEditable,\n            constraint: options.eventConstraint,\n            overlap: typeof options.eventOverlap === 'boolean' ? options.eventOverlap : undefined,\n            allow: options.eventAllow,\n            backgroundColor: options.eventBackgroundColor,\n            borderColor: options.eventBorderColor,\n            textColor: options.eventTextColor,\n            color: options.eventColor,\n            // classNames: options.eventClassNames // render hook will handle this\n        }, calendarContext),\n        selectionConfig: createEventUi({\n            constraint: options.selectConstraint,\n            overlap: typeof options.selectOverlap === 'boolean' ? options.selectOverlap : undefined,\n            allow: options.selectAllow,\n        }, calendarContext),\n    };\n}\nfunction computeIsLoading(state, context) {\n    for (let isLoadingFunc of context.pluginHooks.isLoadingFuncs) {\n        if (isLoadingFunc(state)) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction parseContextBusinessHours(calendarContext) {\n    return parseBusinessHours(calendarContext.options.businessHours, calendarContext);\n}\nfunction warnUnknownOptions(options, viewName) {\n    for (let optionName in options) {\n        console.warn(`Unknown option '${optionName}'` +\n            (viewName ? ` for view '${viewName}'` : ''));\n    }\n}\n\nclass ToolbarSection extends BaseComponent {\n    render() {\n        let children = this.props.widgetGroups.map((widgetGroup) => this.renderWidgetGroup(widgetGroup));\n        return createElement('div', { className: 'fc-toolbar-chunk' }, ...children);\n    }\n    renderWidgetGroup(widgetGroup) {\n        let { props } = this;\n        let { theme } = this.context;\n        let children = [];\n        let isOnlyButtons = true;\n        for (let widget of widgetGroup) {\n            let { buttonName, buttonClick, buttonText, buttonIcon, buttonHint } = widget;\n            if (buttonName === 'title') {\n                isOnlyButtons = false;\n                children.push(createElement(\"h2\", { className: \"fc-toolbar-title\", id: props.titleId }, props.title));\n            }\n            else {\n                let isPressed = buttonName === props.activeButton;\n                let isDisabled = (!props.isTodayEnabled && buttonName === 'today') ||\n                    (!props.isPrevEnabled && buttonName === 'prev') ||\n                    (!props.isNextEnabled && buttonName === 'next');\n                let buttonClasses = [`fc-${buttonName}-button`, theme.getClass('button')];\n                if (isPressed) {\n                    buttonClasses.push(theme.getClass('buttonActive'));\n                }\n                children.push(createElement(\"button\", { type: \"button\", title: typeof buttonHint === 'function' ? buttonHint(props.navUnit) : buttonHint, disabled: isDisabled, \"aria-pressed\": isPressed, className: buttonClasses.join(' '), onClick: buttonClick }, buttonText || (buttonIcon ? createElement(\"span\", { className: buttonIcon, role: \"img\" }) : '')));\n            }\n        }\n        if (children.length > 1) {\n            let groupClassName = (isOnlyButtons && theme.getClass('buttonGroup')) || '';\n            return createElement('div', { className: groupClassName }, ...children);\n        }\n        return children[0];\n    }\n}\n\nclass Toolbar extends BaseComponent {\n    render() {\n        let { model, extraClassName } = this.props;\n        let forceLtr = false;\n        let startContent;\n        let endContent;\n        let sectionWidgets = model.sectionWidgets;\n        let centerContent = sectionWidgets.center;\n        if (sectionWidgets.left) {\n            forceLtr = true;\n            startContent = sectionWidgets.left;\n        }\n        else {\n            startContent = sectionWidgets.start;\n        }\n        if (sectionWidgets.right) {\n            forceLtr = true;\n            endContent = sectionWidgets.right;\n        }\n        else {\n            endContent = sectionWidgets.end;\n        }\n        let classNames = [\n            extraClassName || '',\n            'fc-toolbar',\n            forceLtr ? 'fc-toolbar-ltr' : '',\n        ];\n        return (createElement(\"div\", { className: classNames.join(' ') },\n            this.renderSection('start', startContent || []),\n            this.renderSection('center', centerContent || []),\n            this.renderSection('end', endContent || [])));\n    }\n    renderSection(key, widgetGroups) {\n        let { props } = this;\n        return (createElement(ToolbarSection, { key: key, widgetGroups: widgetGroups, title: props.title, navUnit: props.navUnit, activeButton: props.activeButton, isTodayEnabled: props.isTodayEnabled, isPrevEnabled: props.isPrevEnabled, isNextEnabled: props.isNextEnabled, titleId: props.titleId }));\n    }\n}\n\nclass ViewHarness extends BaseComponent {\n    constructor() {\n        super(...arguments);\n        this.state = {\n            availableWidth: null,\n        };\n        this.handleEl = (el) => {\n            this.el = el;\n            setRef(this.props.elRef, el);\n            this.updateAvailableWidth();\n        };\n        this.handleResize = () => {\n            this.updateAvailableWidth();\n        };\n    }\n    render() {\n        let { props, state } = this;\n        let { aspectRatio } = props;\n        let classNames = [\n            'fc-view-harness',\n            (aspectRatio || props.liquid || props.height)\n                ? 'fc-view-harness-active' // harness controls the height\n                : 'fc-view-harness-passive', // let the view do the height\n        ];\n        let height = '';\n        let paddingBottom = '';\n        if (aspectRatio) {\n            if (state.availableWidth !== null) {\n                height = state.availableWidth / aspectRatio;\n            }\n            else {\n                // while waiting to know availableWidth, we can't set height to *zero*\n                // because will cause lots of unnecessary scrollbars within scrollgrid.\n                // BETTER: don't start rendering ANYTHING yet until we know container width\n                // NOTE: why not always use paddingBottom? Causes height oscillation (issue 5606)\n                paddingBottom = `${(1 / aspectRatio) * 100}%`;\n            }\n        }\n        else {\n            height = props.height || '';\n        }\n        return (createElement(\"div\", { \"aria-labelledby\": props.labeledById, ref: this.handleEl, className: classNames.join(' '), style: { height, paddingBottom } }, props.children));\n    }\n    componentDidMount() {\n        this.context.addResizeHandler(this.handleResize);\n    }\n    componentWillUnmount() {\n        this.context.removeResizeHandler(this.handleResize);\n    }\n    updateAvailableWidth() {\n        if (this.el && // needed. but why?\n            this.props.aspectRatio // aspectRatio is the only height setting that needs availableWidth\n        ) {\n            this.setState({ availableWidth: this.el.offsetWidth });\n        }\n    }\n}\n\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\nclass EventClicking extends Interaction {\n    constructor(settings) {\n        super(settings);\n        this.handleSegClick = (ev, segEl) => {\n            let { component } = this;\n            let { context } = component;\n            let seg = getElSeg(segEl);\n            if (seg && // might be the <div> surrounding the more link\n                component.isValidSegDownEl(ev.target)) {\n                // our way to simulate a link click for elements that can't be <a> tags\n                // grab before trigger fired in case trigger trashes DOM thru rerendering\n                let hasUrlContainer = elementClosest(ev.target, '.fc-event-forced-url');\n                let url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n                context.emitter.trigger('eventClick', {\n                    el: segEl,\n                    event: new EventImpl(component.context, seg.eventRange.def, seg.eventRange.instance),\n                    jsEvent: ev,\n                    view: context.viewApi,\n                });\n                if (url && !ev.defaultPrevented) {\n                    window.location.href = url;\n                }\n            }\n        };\n        this.destroy = listenBySelector(settings.el, 'click', '.fc-event', // on both fg and bg events\n        this.handleSegClick);\n    }\n}\n\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\nclass EventHovering extends Interaction {\n    constructor(settings) {\n        super(settings);\n        // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n        this.handleEventElRemove = (el) => {\n            if (el === this.currentSegEl) {\n                this.handleSegLeave(null, this.currentSegEl);\n            }\n        };\n        this.handleSegEnter = (ev, segEl) => {\n            if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\n                this.currentSegEl = segEl;\n                this.triggerEvent('eventMouseEnter', ev, segEl);\n            }\n        };\n        this.handleSegLeave = (ev, segEl) => {\n            if (this.currentSegEl) {\n                this.currentSegEl = null;\n                this.triggerEvent('eventMouseLeave', ev, segEl);\n            }\n        };\n        this.removeHoverListeners = listenToHoverBySelector(settings.el, '.fc-event', // on both fg and bg events\n        this.handleSegEnter, this.handleSegLeave);\n    }\n    destroy() {\n        this.removeHoverListeners();\n    }\n    triggerEvent(publicEvName, ev, segEl) {\n        let { component } = this;\n        let { context } = component;\n        let seg = getElSeg(segEl);\n        if (!ev || component.isValidSegDownEl(ev.target)) {\n            context.emitter.trigger(publicEvName, {\n                el: segEl,\n                event: new EventImpl(context, seg.eventRange.def, seg.eventRange.instance),\n                jsEvent: ev,\n                view: context.viewApi,\n            });\n        }\n    }\n}\n\nclass CalendarContent extends PureComponent {\n    constructor() {\n        super(...arguments);\n        this.buildViewContext = memoize(buildViewContext);\n        this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n        this.buildToolbarProps = memoize(buildToolbarProps);\n        this.headerRef = createRef();\n        this.footerRef = createRef();\n        this.interactionsStore = {};\n        // eslint-disable-next-line\n        this.state = {\n            viewLabelId: getUniqueDomId(),\n        };\n        // Component Registration\n        // -----------------------------------------------------------------------------------------------------------------\n        this.registerInteractiveComponent = (component, settingsInput) => {\n            let settings = parseInteractionSettings(component, settingsInput);\n            let DEFAULT_INTERACTIONS = [\n                EventClicking,\n                EventHovering,\n            ];\n            let interactionClasses = DEFAULT_INTERACTIONS.concat(this.props.pluginHooks.componentInteractions);\n            let interactions = interactionClasses.map((TheInteractionClass) => new TheInteractionClass(settings));\n            this.interactionsStore[component.uid] = interactions;\n            interactionSettingsStore[component.uid] = settings;\n        };\n        this.unregisterInteractiveComponent = (component) => {\n            let listeners = this.interactionsStore[component.uid];\n            if (listeners) {\n                for (let listener of listeners) {\n                    listener.destroy();\n                }\n                delete this.interactionsStore[component.uid];\n            }\n            delete interactionSettingsStore[component.uid];\n        };\n        // Resizing\n        // -----------------------------------------------------------------------------------------------------------------\n        this.resizeRunner = new DelayedRunner(() => {\n            this.props.emitter.trigger('_resize', true); // should window resizes be considered \"forced\" ?\n            this.props.emitter.trigger('windowResize', { view: this.props.viewApi });\n        });\n        this.handleWindowResize = (ev) => {\n            let { options } = this.props;\n            if (options.handleWindowResize &&\n                ev.target === window // avoid jqui events\n            ) {\n                this.resizeRunner.request(options.windowResizeDelay);\n            }\n        };\n    }\n    /*\n    renders INSIDE of an outer div\n    */\n    render() {\n        let { props } = this;\n        let { toolbarConfig, options } = props;\n        let toolbarProps = this.buildToolbarProps(props.viewSpec, props.dateProfile, props.dateProfileGenerator, props.currentDate, getNow(props.options.now, props.dateEnv), // TODO: use NowTimer????\n        props.viewTitle);\n        let viewVGrow = false;\n        let viewHeight = '';\n        let viewAspectRatio;\n        if (props.isHeightAuto || props.forPrint) {\n            viewHeight = '';\n        }\n        else if (options.height != null) {\n            viewVGrow = true;\n        }\n        else if (options.contentHeight != null) {\n            viewHeight = options.contentHeight;\n        }\n        else {\n            viewAspectRatio = Math.max(options.aspectRatio, 0.5); // prevent from getting too tall\n        }\n        let viewContext = this.buildViewContext(props.viewSpec, props.viewApi, props.options, props.dateProfileGenerator, props.dateEnv, props.theme, props.pluginHooks, props.dispatch, props.getCurrentData, props.emitter, props.calendarApi, this.registerInteractiveComponent, this.unregisterInteractiveComponent);\n        let viewLabelId = (toolbarConfig.header && toolbarConfig.header.hasTitle)\n            ? this.state.viewLabelId\n            : undefined;\n        return (createElement(ViewContextType.Provider, { value: viewContext },\n            toolbarConfig.header && (createElement(Toolbar, Object.assign({ ref: this.headerRef, extraClassName: \"fc-header-toolbar\", model: toolbarConfig.header, titleId: viewLabelId }, toolbarProps))),\n            createElement(ViewHarness, { liquid: viewVGrow, height: viewHeight, aspectRatio: viewAspectRatio, labeledById: viewLabelId },\n                this.renderView(props),\n                this.buildAppendContent()),\n            toolbarConfig.footer && (createElement(Toolbar, Object.assign({ ref: this.footerRef, extraClassName: \"fc-footer-toolbar\", model: toolbarConfig.footer, titleId: \"\" }, toolbarProps)))));\n    }\n    componentDidMount() {\n        let { props } = this;\n        this.calendarInteractions = props.pluginHooks.calendarInteractions\n            .map((CalendarInteractionClass) => new CalendarInteractionClass(props));\n        window.addEventListener('resize', this.handleWindowResize);\n        let { propSetHandlers } = props.pluginHooks;\n        for (let propName in propSetHandlers) {\n            propSetHandlers[propName](props[propName], props);\n        }\n    }\n    componentDidUpdate(prevProps) {\n        let { props } = this;\n        let { propSetHandlers } = props.pluginHooks;\n        for (let propName in propSetHandlers) {\n            if (props[propName] !== prevProps[propName]) {\n                propSetHandlers[propName](props[propName], props);\n            }\n        }\n    }\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleWindowResize);\n        this.resizeRunner.clear();\n        for (let interaction of this.calendarInteractions) {\n            interaction.destroy();\n        }\n        this.props.emitter.trigger('_unmount');\n    }\n    buildAppendContent() {\n        let { props } = this;\n        let children = props.pluginHooks.viewContainerAppends.map((buildAppendContent) => buildAppendContent(props));\n        return createElement(Fragment, {}, ...children);\n    }\n    renderView(props) {\n        let { pluginHooks } = props;\n        let { viewSpec } = props;\n        let viewProps = {\n            dateProfile: props.dateProfile,\n            businessHours: props.businessHours,\n            eventStore: props.renderableEventStore,\n            eventUiBases: props.eventUiBases,\n            dateSelection: props.dateSelection,\n            eventSelection: props.eventSelection,\n            eventDrag: props.eventDrag,\n            eventResize: props.eventResize,\n            isHeightAuto: props.isHeightAuto,\n            forPrint: props.forPrint,\n        };\n        let transformers = this.buildViewPropTransformers(pluginHooks.viewPropsTransformers);\n        for (let transformer of transformers) {\n            Object.assign(viewProps, transformer.transform(viewProps, props));\n        }\n        let ViewComponent = viewSpec.component;\n        return (createElement(ViewComponent, Object.assign({}, viewProps)));\n    }\n}\nfunction buildToolbarProps(viewSpec, dateProfile, dateProfileGenerator, currentDate, now, title) {\n    // don't force any date-profiles to valid date profiles (the `false`) so that we can tell if it's invalid\n    let todayInfo = dateProfileGenerator.build(now, undefined, false); // TODO: need `undefined` or else INFINITE LOOP for some reason\n    let prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate, false);\n    let nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate, false);\n    return {\n        title,\n        activeButton: viewSpec.type,\n        navUnit: viewSpec.singleUnit,\n        isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n        isPrevEnabled: prevInfo.isValid,\n        isNextEnabled: nextInfo.isValid,\n    };\n}\n// Plugin\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildViewPropTransformers(theClasses) {\n    return theClasses.map((TheClass) => new TheClass());\n}\n\nclass Calendar extends CalendarImpl {\n    constructor(el, optionOverrides = {}) {\n        super();\n        this.isRendering = false;\n        this.isRendered = false;\n        this.currentClassNames = [];\n        this.customContentRenderId = 0;\n        this.handleAction = (action) => {\n            // actions we know we want to render immediately\n            switch (action.type) {\n                case 'SET_EVENT_DRAG':\n                case 'SET_EVENT_RESIZE':\n                    this.renderRunner.tryDrain();\n            }\n        };\n        this.handleData = (data) => {\n            this.currentData = data;\n            this.renderRunner.request(data.calendarOptions.rerenderDelay);\n        };\n        this.handleRenderRequest = () => {\n            if (this.isRendering) {\n                this.isRendered = true;\n                let { currentData } = this;\n                flushSync(() => {\n                    render(createElement(CalendarRoot, { options: currentData.calendarOptions, theme: currentData.theme, emitter: currentData.emitter }, (classNames, height, isHeightAuto, forPrint) => {\n                        this.setClassNames(classNames);\n                        this.setHeight(height);\n                        return (createElement(RenderId.Provider, { value: this.customContentRenderId },\n                            createElement(CalendarContent, Object.assign({ isHeightAuto: isHeightAuto, forPrint: forPrint }, currentData))));\n                    }), this.el);\n                });\n            }\n            else if (this.isRendered) {\n                this.isRendered = false;\n                render(null, this.el);\n                this.setClassNames([]);\n                this.setHeight('');\n            }\n        };\n        ensureElHasStyles(el);\n        this.el = el;\n        this.renderRunner = new DelayedRunner(this.handleRenderRequest);\n        new CalendarDataManager({\n            optionOverrides,\n            calendarApi: this,\n            onAction: this.handleAction,\n            onData: this.handleData,\n        });\n    }\n    render() {\n        let wasRendering = this.isRendering;\n        if (!wasRendering) {\n            this.isRendering = true;\n        }\n        else {\n            this.customContentRenderId += 1;\n        }\n        this.renderRunner.request();\n        if (wasRendering) {\n            this.updateSize();\n        }\n    }\n    destroy() {\n        if (this.isRendering) {\n            this.isRendering = false;\n            this.renderRunner.request();\n        }\n    }\n    updateSize() {\n        flushSync(() => {\n            super.updateSize();\n        });\n    }\n    batchRendering(func) {\n        this.renderRunner.pause('batchRendering');\n        func();\n        this.renderRunner.resume('batchRendering');\n    }\n    pauseRendering() {\n        this.renderRunner.pause('pauseRendering');\n    }\n    resumeRendering() {\n        this.renderRunner.resume('pauseRendering', true);\n    }\n    resetOptions(optionOverrides, changedOptionNames) {\n        this.currentDataManager.resetOptions(optionOverrides, changedOptionNames);\n    }\n    setClassNames(classNames) {\n        if (!isArraysEqual(classNames, this.currentClassNames)) {\n            let { classList } = this.el;\n            for (let className of this.currentClassNames) {\n                classList.remove(className);\n            }\n            for (let className of classNames) {\n                classList.add(className);\n            }\n            this.currentClassNames = classNames;\n        }\n    }\n    setHeight(height) {\n        applyStyleProp(this.el, 'height', height);\n    }\n}\n\nfunction formatDate(dateInput, options = {}) {\n    let dateEnv = buildDateEnv(options);\n    let formatter = createFormatter(options);\n    let dateMeta = dateEnv.createMarkerMeta(dateInput);\n    if (!dateMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.format(dateMeta.marker, formatter, {\n        forcedTzo: dateMeta.forcedTzo,\n    });\n}\nfunction formatRange(startInput, endInput, options) {\n    let dateEnv = buildDateEnv(typeof options === 'object' && options ? options : {}); // pass in if non-null object\n    let formatter = createFormatter(options);\n    let startMeta = dateEnv.createMarkerMeta(startInput);\n    let endMeta = dateEnv.createMarkerMeta(endInput);\n    if (!startMeta || !endMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n        forcedStartTzo: startMeta.forcedTzo,\n        forcedEndTzo: endMeta.forcedTzo,\n        isEndExclusive: options.isEndExclusive,\n        defaultSeparator: BASE_OPTION_DEFAULTS.defaultRangeSeparator,\n    });\n}\n// TODO: more DRY and optimized\nfunction buildDateEnv(settings) {\n    let locale = buildLocale(settings.locale || 'en', organizeRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n    return new DateEnv(Object.assign(Object.assign({ timeZone: BASE_OPTION_DEFAULTS.timeZone, calendarSystem: 'gregory' }, settings), { locale }));\n}\n\n// HELPERS\n/*\nif nextDayThreshold is specified, slicing is done in an all-day fashion.\nyou can get nextDayThreshold from context.nextDayThreshold\n*/\nfunction sliceEvents(props, allDay) {\n    return sliceEventStore(props.eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? props.nextDayThreshold : null).fg;\n}\n\nconst version = '6.1.11';\n\nexport { Calendar, createPlugin, formatDate, formatRange, globalLocales, globalPlugins, sliceEvents, version };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}